{"remainingRequest":"/Users/jonny/Desktop/myProjects/Kalaam-core/FE/node_modules/babel-loader/lib/index.js!/Users/jonny/Desktop/myProjects/Kalaam-core/FE/node_modules/quasar/src/components/select/QSelect.js","dependencies":[{"path":"/Users/jonny/Desktop/myProjects/Kalaam-core/FE/node_modules/quasar/src/components/select/QSelect.js","mtime":499162500000},{"path":"/Users/jonny/Desktop/myProjects/Kalaam-core/FE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jonny/Desktop/myProjects/Kalaam-core/FE/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pcy1hcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLm5vdyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIi9Vc2Vycy9qb25ueS9EZXNrdG9wL215UHJvamVjdHMvS2FsYWFtLWNvcmUvRkUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmltcG9ydCBWdWUgZnJvbSAndnVlJzsKaW1wb3J0IFFGaWVsZCBmcm9tICcuLi9maWVsZC9RRmllbGQuanMnOwppbXBvcnQgUUljb24gZnJvbSAnLi4vaWNvbi9RSWNvbi5qcyc7CmltcG9ydCBRQ2hpcCBmcm9tICcuLi9jaGlwL1FDaGlwLmpzJzsKaW1wb3J0IFFJdGVtIGZyb20gJy4uL2l0ZW0vUUl0ZW0uanMnOwppbXBvcnQgUUl0ZW1TZWN0aW9uIGZyb20gJy4uL2l0ZW0vUUl0ZW1TZWN0aW9uLmpzJzsKaW1wb3J0IFFJdGVtTGFiZWwgZnJvbSAnLi4vaXRlbS9RSXRlbUxhYmVsLmpzJzsKaW1wb3J0IFFNZW51IGZyb20gJy4uL21lbnUvUU1lbnUuanMnOwppbXBvcnQgUURpYWxvZyBmcm9tICcuLi9kaWFsb2cvUURpYWxvZy5qcyc7CmltcG9ydCB7IGlzRGVlcEVxdWFsIH0gZnJvbSAnLi4vLi4vdXRpbHMvaXMuanMnOwppbXBvcnQgeyBzdG9wLCBwcmV2ZW50LCBzdG9wQW5kUHJldmVudCB9IGZyb20gJy4uLy4uL3V0aWxzL2V2ZW50LmpzJzsKaW1wb3J0IHsgbm9ybWFsaXplVG9JbnRlcnZhbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zvcm1hdC5qcyc7CmltcG9ydCB7IHNob3VsZElnbm9yZUtleSwgaXNLZXlDb2RlIH0gZnJvbSAnLi4vLi4vdXRpbHMva2V5LWNvbXBvc2l0aW9uLmpzJzsKaW1wb3J0IHsgbWVyZ2VTbG90IH0gZnJvbSAnLi4vLi4vdXRpbHMvc2xvdC5qcyc7CmltcG9ydCBjYWNoZSBmcm9tICcuLi8uLi91dGlscy9jYWNoZS5qcyc7CmltcG9ydCB7IEZvcm1GaWVsZE1peGluIH0gZnJvbSAnLi4vLi4vbWl4aW5zL2Zvcm0uanMnOwppbXBvcnQgVmlydHVhbFNjcm9sbCBmcm9tICcuLi8uLi9taXhpbnMvdmlydHVhbC1zY3JvbGwuanMnOwppbXBvcnQgQ29tcG9zaXRpb25NaXhpbiBmcm9tICcuLi8uLi9taXhpbnMvY29tcG9zaXRpb24uanMnOwppbXBvcnQgTGlzdGVuZXJzTWl4aW4gZnJvbSAnLi4vLi4vbWl4aW5zL2xpc3RlbmVycy5qcyc7Cgp2YXIgdmFsaWRhdGVOZXdWYWx1ZU1vZGUgPSBmdW5jdGlvbiB2YWxpZGF0ZU5ld1ZhbHVlTW9kZSh2KSB7CiAgcmV0dXJuIFsnYWRkJywgJ2FkZC11bmlxdWUnLCAndG9nZ2xlJ10uaW5jbHVkZXModik7Cn07Cgp2YXIgcmVFc2NhcGVMaXN0ID0gJy4qKz9eJHt9KCl8W11cXCc7CmV4cG9ydCBkZWZhdWx0IFZ1ZS5leHRlbmQoewogIG5hbWU6ICdRU2VsZWN0JywKICBtaXhpbnM6IFtRRmllbGQsIFZpcnR1YWxTY3JvbGwsIENvbXBvc2l0aW9uTWl4aW4sIEZvcm1GaWVsZE1peGluLCBMaXN0ZW5lcnNNaXhpbl0sCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogICAgbXVsdGlwbGU6IEJvb2xlYW4sCiAgICBkaXNwbGF5VmFsdWU6IFtTdHJpbmcsIE51bWJlcl0sCiAgICBkaXNwbGF5VmFsdWVTYW5pdGl6ZTogQm9vbGVhbiwKICAgIGRyb3Bkb3duSWNvbjogU3RyaW5nLAogICAgb3B0aW9uczogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgImRlZmF1bHQiOiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0KICAgIH0sCiAgICBvcHRpb25WYWx1ZTogW0Z1bmN0aW9uLCBTdHJpbmddLAogICAgb3B0aW9uTGFiZWw6IFtGdW5jdGlvbiwgU3RyaW5nXSwKICAgIG9wdGlvbkRpc2FibGU6IFtGdW5jdGlvbiwgU3RyaW5nXSwKICAgIGhpZGVTZWxlY3RlZDogQm9vbGVhbiwKICAgIGhpZGVEcm9wZG93bkljb246IEJvb2xlYW4sCiAgICBmaWxsSW5wdXQ6IEJvb2xlYW4sCiAgICBtYXhWYWx1ZXM6IFtOdW1iZXIsIFN0cmluZ10sCiAgICBvcHRpb25zRGVuc2U6IEJvb2xlYW4sCiAgICBvcHRpb25zRGFyazogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICAiZGVmYXVsdCI6IG51bGwKICAgIH0sCiAgICBvcHRpb25zU2VsZWN0ZWRDbGFzczogU3RyaW5nLAogICAgb3B0aW9uc1Nhbml0aXplOiBCb29sZWFuLAogICAgb3B0aW9uc0NvdmVyOiBCb29sZWFuLAogICAgbWVudVNocmluazogQm9vbGVhbiwKICAgIG1lbnVBbmNob3I6IFN0cmluZywKICAgIG1lbnVTZWxmOiBTdHJpbmcsCiAgICBtZW51T2Zmc2V0OiBBcnJheSwKICAgIHBvcHVwQ29udGVudENsYXNzOiBTdHJpbmcsCiAgICBwb3B1cENvbnRlbnRTdHlsZTogW1N0cmluZywgQXJyYXksIE9iamVjdF0sCiAgICB1c2VJbnB1dDogQm9vbGVhbiwKICAgIHVzZUNoaXBzOiBCb29sZWFuLAogICAgbmV3VmFsdWVNb2RlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZU5ld1ZhbHVlTW9kZQogICAgfSwKICAgIG1hcE9wdGlvbnM6IEJvb2xlYW4sCiAgICBlbWl0VmFsdWU6IEJvb2xlYW4sCiAgICBpbnB1dERlYm91bmNlOiB7CiAgICAgIHR5cGU6IFtOdW1iZXIsIFN0cmluZ10sCiAgICAgICJkZWZhdWx0IjogNTAwCiAgICB9LAogICAgaW5wdXRDbGFzczogW0FycmF5LCBTdHJpbmcsIE9iamVjdF0sCiAgICBpbnB1dFN0eWxlOiBbQXJyYXksIFN0cmluZywgT2JqZWN0XSwKICAgIHRhYmluZGV4OiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIE51bWJlcl0sCiAgICAgICJkZWZhdWx0IjogMAogICAgfSwKICAgIHRyYW5zaXRpb25TaG93OiBTdHJpbmcsCiAgICB0cmFuc2l0aW9uSGlkZTogU3RyaW5nLAogICAgYmVoYXZpb3I6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcih2KSB7CiAgICAgICAgcmV0dXJuIFsnZGVmYXVsdCcsICdtZW51JywgJ2RpYWxvZyddLmluY2x1ZGVzKHYpOwogICAgICB9LAogICAgICAiZGVmYXVsdCI6ICdkZWZhdWx0JwogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1lbnU6IGZhbHNlLAogICAgICBkaWFsb2c6IGZhbHNlLAogICAgICBvcHRpb25JbmRleDogLTEsCiAgICAgIGlucHV0VmFsdWU6ICcnLAogICAgICBkaWFsb2dGaWVsZEZvY3VzZWQ6IGZhbHNlCiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIGlubmVyVmFsdWU6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcih2YWwpIHsKICAgICAgICB0aGlzLmlubmVyVmFsdWVDYWNoZSA9IHZhbDsKCiAgICAgICAgaWYgKHRoaXMudXNlSW5wdXQgPT09IHRydWUgJiYgdGhpcy5maWxsSW5wdXQgPT09IHRydWUgJiYgdGhpcy5tdWx0aXBsZSAhPT0gdHJ1ZSAmJiAvLyBQcmV2ZW50IHJlLWVudGVyaW5nIGluIGZpbHRlciB3aGlsZSBmaWx0ZXJpbmcKICAgICAgICAvLyBBbHNvIHByZXZlbnQgY2xlYXJpbmcgaW5wdXRWYWx1ZSB3aGlsZSBmaWx0ZXJpbmcKICAgICAgICB0aGlzLmlubmVyTG9hZGluZyAhPT0gdHJ1ZSAmJiAodGhpcy5kaWFsb2cgIT09IHRydWUgJiYgdGhpcy5tZW51ICE9PSB0cnVlIHx8IHRoaXMuaGFzVmFsdWUgIT09IHRydWUpKSB7CiAgICAgICAgICB0aGlzLnVzZXJJbnB1dFZhbHVlICE9PSB0cnVlICYmIHRoaXMuX19yZXNldElucHV0VmFsdWUoKTsKCiAgICAgICAgICBpZiAodGhpcy5kaWFsb2cgPT09IHRydWUgfHwgdGhpcy5tZW51ID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMuZmlsdGVyKCcnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGltbWVkaWF0ZTogdHJ1ZQogICAgfSwKICAgIGZpbGxJbnB1dDogZnVuY3Rpb24gZmlsbElucHV0KCkgewogICAgICB0aGlzLl9fcmVzZXRJbnB1dFZhbHVlKCk7CiAgICB9LAogICAgbWVudTogZnVuY3Rpb24gbWVudShzaG93KSB7CiAgICAgIHRoaXMuX191cGRhdGVNZW51KHNob3cpOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzT3B0aW9uc0Rhcms6IGZ1bmN0aW9uIGlzT3B0aW9uc0RhcmsoKSB7CiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNEYXJrID09PSBudWxsID8gdGhpcy5pc0RhcmsgOiB0aGlzLm9wdGlvbnNEYXJrOwogICAgfSwKICAgIHZpcnR1YWxTY3JvbGxMZW5ndGg6IGZ1bmN0aW9uIHZpcnR1YWxTY3JvbGxMZW5ndGgoKSB7CiAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHRoaXMub3B0aW9ucykgPyB0aGlzLm9wdGlvbnMubGVuZ3RoIDogMDsKICAgIH0sCiAgICBmaWVsZENsYXNzOiBmdW5jdGlvbiBmaWVsZENsYXNzKCkgewogICAgICByZXR1cm4gInEtc2VsZWN0IHEtZmllbGQtLWF1dG8taGVpZ2h0IHEtc2VsZWN0LS13aXRoIi5jb25jYXQodGhpcy51c2VJbnB1dCAhPT0gdHJ1ZSA/ICdvdXQnIDogJycsICItaW5wdXQgcS1zZWxlY3QtLXdpdGgiKS5jb25jYXQodGhpcy51c2VDaGlwcyAhPT0gdHJ1ZSA/ICdvdXQnIDogJycsICItY2hpcHMiKTsKICAgIH0sCiAgICBjb21wdXRlZElucHV0Q2xhc3M6IGZ1bmN0aW9uIGNvbXB1dGVkSW5wdXRDbGFzcygpIHsKICAgICAgaWYgKHRoaXMuaGlkZVNlbGVjdGVkID09PSB0cnVlIHx8IHRoaXMuaW5uZXJWYWx1ZS5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5pbnB1dENsYXNzOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5pbnB1dENsYXNzID09PSB2b2lkIDAgPyAncS1maWVsZF9faW5wdXQtLXBhZGRpbmcnIDogW3RoaXMuaW5wdXRDbGFzcywgJ3EtZmllbGRfX2lucHV0LS1wYWRkaW5nJ107CiAgICB9LAogICAgbWVudUNvbnRlbnRDbGFzczogZnVuY3Rpb24gbWVudUNvbnRlbnRDbGFzcygpIHsKICAgICAgcmV0dXJuICh0aGlzLnZpcnR1YWxTY3JvbGxIb3Jpem9udGFsID09PSB0cnVlID8gJ3EtdmlydHVhbC1zY3JvbGwtLWhvcml6b250YWwnIDogJycpICsgKHRoaXMucG9wdXBDb250ZW50Q2xhc3MgPyAnICcgKyB0aGlzLnBvcHVwQ29udGVudENsYXNzIDogJycpOwogICAgfSwKICAgIGlubmVyVmFsdWU6IGZ1bmN0aW9uIGlubmVyVmFsdWUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgbWFwTnVsbCA9IHRoaXMubWFwT3B0aW9ucyA9PT0gdHJ1ZSAmJiB0aGlzLm11bHRpcGxlICE9PSB0cnVlLAogICAgICAgICAgdmFsID0gdGhpcy52YWx1ZSAhPT0gdm9pZCAwICYmICh0aGlzLnZhbHVlICE9PSBudWxsIHx8IG1hcE51bGwgPT09IHRydWUpID8gdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSAmJiBBcnJheS5pc0FycmF5KHRoaXMudmFsdWUpID8gdGhpcy52YWx1ZSA6IFt0aGlzLnZhbHVlXSA6IFtdOwoKICAgICAgaWYgKHRoaXMubWFwT3B0aW9ucyA9PT0gdHJ1ZSAmJiBBcnJheS5pc0FycmF5KHRoaXMub3B0aW9ucykgPT09IHRydWUpIHsKICAgICAgICB2YXIgX2NhY2hlID0gdGhpcy5tYXBPcHRpb25zID09PSB0cnVlICYmIHRoaXMuaW5uZXJWYWx1ZUNhY2hlICE9PSB2b2lkIDAgPyB0aGlzLmlubmVyVmFsdWVDYWNoZSA6IFtdOwoKICAgICAgICB2YXIgdmFsdWVzID0gdmFsLm1hcChmdW5jdGlvbiAodikgewogICAgICAgICAgcmV0dXJuIF90aGlzLl9fZ2V0T3B0aW9uKHYsIF9jYWNoZSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG51bGwgJiYgbWFwTnVsbCA9PT0gdHJ1ZSA/IHZhbHVlcy5maWx0ZXIoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgIHJldHVybiB2ICE9PSBudWxsOwogICAgICAgIH0pIDogdmFsdWVzOwogICAgICB9CgogICAgICByZXR1cm4gdmFsOwogICAgfSwKICAgIG5vT3B0aW9uczogZnVuY3Rpb24gbm9PcHRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy52aXJ0dWFsU2Nyb2xsTGVuZ3RoID09PSAwOwogICAgfSwKICAgIHNlbGVjdGVkU3RyaW5nOiBmdW5jdGlvbiBzZWxlY3RlZFN0cmluZygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy5pbm5lclZhbHVlLm1hcChmdW5jdGlvbiAob3B0KSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5nZXRPcHRpb25MYWJlbChvcHQpOwogICAgICB9KS5qb2luKCcsICcpOwogICAgfSwKICAgIHNhbml0aXplRm46IGZ1bmN0aW9uIHNhbml0aXplRm4oKSB7CiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNTYW5pdGl6ZSA9PT0gdHJ1ZSA/IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSA6IGZ1bmN0aW9uIChvcHQpIHsKICAgICAgICByZXR1cm4gb3B0ICE9PSB2b2lkIDAgJiYgb3B0ICE9PSBudWxsICYmIG9wdC5zYW5pdGl6ZSA9PT0gdHJ1ZTsKICAgICAgfTsKICAgIH0sCiAgICBkaXNwbGF5QXNUZXh0OiBmdW5jdGlvbiBkaXNwbGF5QXNUZXh0KCkgewogICAgICByZXR1cm4gdGhpcy5kaXNwbGF5VmFsdWVTYW5pdGl6ZSA9PT0gdHJ1ZSB8fCB0aGlzLmRpc3BsYXlWYWx1ZSA9PT0gdm9pZCAwICYmICh0aGlzLm9wdGlvbnNTYW5pdGl6ZSA9PT0gdHJ1ZSB8fCB0aGlzLmlubmVyVmFsdWUuc29tZSh0aGlzLnNhbml0aXplRm4pKTsKICAgIH0sCiAgICBjb21wdXRlZFRhYmluZGV4OiBmdW5jdGlvbiBjb21wdXRlZFRhYmluZGV4KCkgewogICAgICByZXR1cm4gdGhpcy5mb2N1c2VkID09PSB0cnVlID8gdGhpcy50YWJpbmRleCA6IC0xOwogICAgfSwKICAgIHNlbGVjdGVkU2NvcGU6IGZ1bmN0aW9uIHNlbGVjdGVkU2NvcGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMuaW5uZXJWYWx1ZS5tYXAoZnVuY3Rpb24gKG9wdCwgaSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpbmRleDogaSwKICAgICAgICAgIG9wdDogb3B0LAogICAgICAgICAgc2FuaXRpemU6IF90aGlzMy5zYW5pdGl6ZUZuKG9wdCksCiAgICAgICAgICBzZWxlY3RlZDogdHJ1ZSwKICAgICAgICAgIHJlbW92ZUF0SW5kZXg6IF90aGlzMy5fX3JlbW92ZUF0SW5kZXhBbmRGb2N1cywKICAgICAgICAgIHRvZ2dsZU9wdGlvbjogX3RoaXMzLnRvZ2dsZU9wdGlvbiwKICAgICAgICAgIHRhYmluZGV4OiBfdGhpczMuY29tcHV0ZWRUYWJpbmRleAogICAgICAgIH07CiAgICAgIH0pOwogICAgfSwKICAgIG9wdGlvblNjb3BlOiBmdW5jdGlvbiBvcHRpb25TY29wZSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAodGhpcy52aXJ0dWFsU2Nyb2xsTGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CgogICAgICB2YXIgX3RoaXMkdmlydHVhbFNjcm9sbFNsID0gdGhpcy52aXJ0dWFsU2Nyb2xsU2xpY2VSYW5nZSwKICAgICAgICAgIGZyb20gPSBfdGhpcyR2aXJ0dWFsU2Nyb2xsU2wuZnJvbSwKICAgICAgICAgIHRvID0gX3RoaXMkdmlydHVhbFNjcm9sbFNsLnRvOwogICAgICByZXR1cm4gdGhpcy5vcHRpb25zLnNsaWNlKGZyb20sIHRvKS5tYXAoZnVuY3Rpb24gKG9wdCwgaSkgewogICAgICAgIHZhciBkaXNhYmxlID0gX3RoaXM0LmlzT3B0aW9uRGlzYWJsZWQob3B0KSA9PT0gdHJ1ZTsKICAgICAgICB2YXIgaW5kZXggPSBmcm9tICsgaTsKICAgICAgICB2YXIgaXRlbVByb3BzID0gewogICAgICAgICAgY2xpY2thYmxlOiB0cnVlLAogICAgICAgICAgYWN0aXZlOiBmYWxzZSwKICAgICAgICAgIGFjdGl2ZUNsYXNzOiBfdGhpczQuY29tcHV0ZWRPcHRpb25zU2VsZWN0ZWRDbGFzcywKICAgICAgICAgIG1hbnVhbEZvY3VzOiB0cnVlLAogICAgICAgICAgZm9jdXNlZDogZmFsc2UsCiAgICAgICAgICBkaXNhYmxlOiBkaXNhYmxlLAogICAgICAgICAgdGFiaW5kZXg6IC0xLAogICAgICAgICAgZGVuc2U6IF90aGlzNC5vcHRpb25zRGVuc2UsCiAgICAgICAgICBkYXJrOiBfdGhpczQuaXNPcHRpb25zRGFyawogICAgICAgIH07CgogICAgICAgIGlmIChkaXNhYmxlICE9PSB0cnVlKSB7CiAgICAgICAgICBfdGhpczQuaXNPcHRpb25TZWxlY3RlZChvcHQpID09PSB0cnVlICYmIChpdGVtUHJvcHMuYWN0aXZlID0gdHJ1ZSk7CiAgICAgICAgICBfdGhpczQub3B0aW9uSW5kZXggPT09IGluZGV4ICYmIChpdGVtUHJvcHMuZm9jdXNlZCA9IHRydWUpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGl0ZW1FdmVudHMgPSB7CiAgICAgICAgICBjbGljazogZnVuY3Rpb24gY2xpY2soKSB7CiAgICAgICAgICAgIF90aGlzNC50b2dnbGVPcHRpb24ob3B0KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXM0LiRxLnBsYXRmb3JtLmlzLmRlc2t0b3AgPT09IHRydWUpIHsKICAgICAgICAgIGl0ZW1FdmVudHMubW91c2Vtb3ZlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpczQuc2V0T3B0aW9uSW5kZXgoaW5kZXgpOwogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICBvcHQ6IG9wdCwKICAgICAgICAgIHNhbml0aXplOiBfdGhpczQuc2FuaXRpemVGbihvcHQpLAogICAgICAgICAgc2VsZWN0ZWQ6IGl0ZW1Qcm9wcy5hY3RpdmUsCiAgICAgICAgICBmb2N1c2VkOiBpdGVtUHJvcHMuZm9jdXNlZCwKICAgICAgICAgIHRvZ2dsZU9wdGlvbjogX3RoaXM0LnRvZ2dsZU9wdGlvbiwKICAgICAgICAgIHNldE9wdGlvbkluZGV4OiBfdGhpczQuc2V0T3B0aW9uSW5kZXgsCiAgICAgICAgICBpdGVtUHJvcHM6IGl0ZW1Qcm9wcywKICAgICAgICAgIGl0ZW1FdmVudHM6IGl0ZW1FdmVudHMKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sCiAgICBkcm9wZG93bkFycm93SWNvbjogZnVuY3Rpb24gZHJvcGRvd25BcnJvd0ljb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmRyb3Bkb3duSWNvbiAhPT0gdm9pZCAwID8gdGhpcy5kcm9wZG93bkljb24gOiB0aGlzLiRxLmljb25TZXQuYXJyb3cuZHJvcGRvd247CiAgICB9LAogICAgc3F1YXJlZE1lbnU6IGZ1bmN0aW9uIHNxdWFyZWRNZW51KCkgewogICAgICByZXR1cm4gdGhpcy5vcHRpb25zQ292ZXIgPT09IGZhbHNlICYmIHRoaXMub3V0bGluZWQgIT09IHRydWUgJiYgdGhpcy5zdGFuZG91dCAhPT0gdHJ1ZSAmJiB0aGlzLmJvcmRlcmxlc3MgIT09IHRydWUgJiYgdGhpcy5yb3VuZGVkICE9PSB0cnVlOwogICAgfSwKICAgIGNvbXB1dGVkT3B0aW9uc1NlbGVjdGVkQ2xhc3M6IGZ1bmN0aW9uIGNvbXB1dGVkT3B0aW9uc1NlbGVjdGVkQ2xhc3MoKSB7CiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNTZWxlY3RlZENsYXNzICE9PSB2b2lkIDAgPyB0aGlzLm9wdGlvbnNTZWxlY3RlZENsYXNzIDogdGhpcy5jb2xvciAhPT0gdm9pZCAwID8gInRleHQtIi5jb25jYXQodGhpcy5jb2xvcikgOiAnJzsKICAgIH0sCiAgICBpbm5lck9wdGlvbnNWYWx1ZTogZnVuY3Rpb24gaW5uZXJPcHRpb25zVmFsdWUoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMuaW5uZXJWYWx1ZS5tYXAoZnVuY3Rpb24gKG9wdCkgewogICAgICAgIHJldHVybiBfdGhpczUuZ2V0T3B0aW9uVmFsdWUob3B0KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gcmV0dXJucyBtZXRob2QgdG8gZ2V0IHZhbHVlIG9mIGFuIG9wdGlvbjsKICAgIC8vIHRha2VzIGludG8gYWNjb3VudCAnb3B0aW9uLXZhbHVlJyBwcm9wCiAgICBnZXRPcHRpb25WYWx1ZTogZnVuY3Rpb24gZ2V0T3B0aW9uVmFsdWUoKSB7CiAgICAgIHJldHVybiB0aGlzLl9fZ2V0UHJvcFZhbHVlRm4oJ29wdGlvblZhbHVlJywgJ3ZhbHVlJyk7CiAgICB9LAogICAgLy8gcmV0dXJucyBtZXRob2QgdG8gZ2V0IGxhYmVsIG9mIGFuIG9wdGlvbjsKICAgIC8vIHRha2VzIGludG8gYWNjb3VudCAnb3B0aW9uLWxhYmVsJyBwcm9wCiAgICBnZXRPcHRpb25MYWJlbDogZnVuY3Rpb24gZ2V0T3B0aW9uTGFiZWwoKSB7CiAgICAgIHJldHVybiB0aGlzLl9fZ2V0UHJvcFZhbHVlRm4oJ29wdGlvbkxhYmVsJywgJ2xhYmVsJyk7CiAgICB9LAogICAgLy8gcmV0dXJucyBtZXRob2QgdG8gdGVsbCBpZiBhbiBvcHRpb24gaXMgZGlzYWJsZWQ7CiAgICAvLyB0YWtlcyBpbnRvIGFjY291bnQgJ29wdGlvbi1kaXNhYmxlJyBwcm9wCiAgICBpc09wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiBpc09wdGlvbkRpc2FibGVkKCkgewogICAgICByZXR1cm4gdGhpcy5fX2dldFByb3BWYWx1ZUZuKCdvcHRpb25EaXNhYmxlJywgJ2Rpc2FibGUnKTsKICAgIH0sCiAgICBpbnB1dENvbnRyb2xFdmVudHM6IGZ1bmN0aW9uIGlucHV0Q29udHJvbEV2ZW50cygpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICB2YXIgb24gPSB7CiAgICAgICAgaW5wdXQ6IHRoaXMuX19vbklucHV0LAogICAgICAgIC8vIFNhZmFyaSA8IDEwLjIgJiBVSVdlYlZpZXcgZG9lc24ndCBmaXJlIGNvbXBvc2l0aW9uZW5kIHdoZW4KICAgICAgICAvLyBzd2l0Y2hpbmcgZm9jdXMgYmVmb3JlIGNvbmZpcm1pbmcgY29tcG9zaXRpb24gY2hvaWNlCiAgICAgICAgLy8gdGhpcyBhbHNvIGZpeGVzIHRoZSBpc3N1ZSB3aGVyZSBzb21lIGJyb3dzZXJzIGUuZy4gaU9TIENocm9tZQogICAgICAgIC8vIGZpcmVzICJjaGFuZ2UiIGluc3RlYWQgb2YgImlucHV0IiBvbiBhdXRvY29tcGxldGUuCiAgICAgICAgY2hhbmdlOiB0aGlzLl9fb25DaGFuZ2UsCiAgICAgICAga2V5ZG93bjogdGhpcy5fX29uVGFyZ2V0S2V5ZG93biwKICAgICAgICBrZXl1cDogdGhpcy5fX29uVGFyZ2V0S2V5dXAsCiAgICAgICAga2V5cHJlc3M6IHRoaXMuX19vblRhcmdldEtleXByZXNzLAogICAgICAgIGZvY3VzOiB0aGlzLl9fc2VsZWN0SW5wdXRUZXh0LAogICAgICAgIGNsaWNrOiBmdW5jdGlvbiBjbGljayhlKSB7CiAgICAgICAgICBfdGhpczYuaGFzRGlhbG9nID09PSB0cnVlICYmIHN0b3AoZSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBvbi5jb21wb3NpdGlvbnN0YXJ0ID0gb24uY29tcG9zaXRpb251cGRhdGUgPSBvbi5jb21wb3NpdGlvbmVuZCA9IHRoaXMuX19vbkNvbXBvc2l0aW9uOwogICAgICByZXR1cm4gb247CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRFbWl0dGluZ09wdGlvblZhbHVlOiBmdW5jdGlvbiBnZXRFbWl0dGluZ09wdGlvblZhbHVlKG9wdCkgewogICAgICByZXR1cm4gdGhpcy5lbWl0VmFsdWUgPT09IHRydWUgPyB0aGlzLmdldE9wdGlvblZhbHVlKG9wdCkgOiBvcHQ7CiAgICB9LAogICAgcmVtb3ZlQXRJbmRleDogZnVuY3Rpb24gcmVtb3ZlQXRJbmRleChpbmRleCkgewogICAgICBpZiAoaW5kZXggPiAtMSAmJiBpbmRleCA8IHRoaXMuaW5uZXJWYWx1ZS5sZW5ndGgpIHsKICAgICAgICBpZiAodGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSkgewogICAgICAgICAgdmFyIG1vZGVsID0gdGhpcy52YWx1ZS5zbGljZSgpOwogICAgICAgICAgdGhpcy4kZW1pdCgncmVtb3ZlJywgewogICAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICAgIHZhbHVlOiBtb2RlbC5zcGxpY2UoaW5kZXgsIDEpWzBdCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgbW9kZWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIG51bGwpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIF9fcmVtb3ZlQXRJbmRleEFuZEZvY3VzOiBmdW5jdGlvbiBfX3JlbW92ZUF0SW5kZXhBbmRGb2N1cyhpbmRleCkgewogICAgICB0aGlzLnJlbW92ZUF0SW5kZXgoaW5kZXgpOwoKICAgICAgdGhpcy5fX2ZvY3VzKCk7CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbiBhZGQob3B0LCB1bmlxdWUpIHsKICAgICAgdmFyIHZhbCA9IHRoaXMuZ2V0RW1pdHRpbmdPcHRpb25WYWx1ZShvcHQpOwoKICAgICAgaWYgKHRoaXMubXVsdGlwbGUgIT09IHRydWUpIHsKICAgICAgICB0aGlzLmZpbGxJbnB1dCA9PT0gdHJ1ZSAmJiB0aGlzLnVwZGF0ZUlucHV0VmFsdWUodGhpcy5nZXRPcHRpb25MYWJlbChvcHQpLCB0cnVlLCB0cnVlKTsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHZhbCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5pbm5lclZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHRoaXMuJGVtaXQoJ2FkZCcsIHsKICAgICAgICAgIGluZGV4OiAwLAogICAgICAgICAgdmFsdWU6IHZhbAogICAgICAgIH0pOwogICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSA/IFt2YWxdIDogdmFsKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh1bmlxdWUgPT09IHRydWUgJiYgdGhpcy5pc09wdGlvblNlbGVjdGVkKG9wdCkgPT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm1heFZhbHVlcyAhPT0gdm9pZCAwICYmIHRoaXMudmFsdWUubGVuZ3RoID49IHRoaXMubWF4VmFsdWVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgbW9kZWwgPSB0aGlzLnZhbHVlLnNsaWNlKCk7CiAgICAgIHRoaXMuJGVtaXQoJ2FkZCcsIHsKICAgICAgICBpbmRleDogbW9kZWwubGVuZ3RoLAogICAgICAgIHZhbHVlOiB2YWwKICAgICAgfSk7CiAgICAgIG1vZGVsLnB1c2godmFsKTsKICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBtb2RlbCk7CiAgICB9LAogICAgdG9nZ2xlT3B0aW9uOiBmdW5jdGlvbiB0b2dnbGVPcHRpb24ob3B0LCBrZWVwT3BlbikgewogICAgICBpZiAodGhpcy5lZGl0YWJsZSAhPT0gdHJ1ZSB8fCBvcHQgPT09IHZvaWQgMCB8fCB0aGlzLmlzT3B0aW9uRGlzYWJsZWQob3B0KSA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG9wdFZhbHVlID0gdGhpcy5nZXRPcHRpb25WYWx1ZShvcHQpOwoKICAgICAgaWYgKHRoaXMubXVsdGlwbGUgIT09IHRydWUpIHsKICAgICAgICBpZiAoa2VlcE9wZW4gIT09IHRydWUpIHsKICAgICAgICAgIHRoaXMudXBkYXRlSW5wdXRWYWx1ZSh0aGlzLmZpbGxJbnB1dCA9PT0gdHJ1ZSA/IHRoaXMuZ2V0T3B0aW9uTGFiZWwob3B0KSA6ICcnLCB0cnVlLCB0cnVlKTsKICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLnRhcmdldCAhPT0gdm9pZCAwICYmIHRoaXMuJHJlZnMudGFyZ2V0LmZvY3VzKCk7CgogICAgICAgIGlmIChpc0RlZXBFcXVhbCh0aGlzLmdldE9wdGlvblZhbHVlKHRoaXMuaW5uZXJWYWx1ZVswXSksIG9wdFZhbHVlKSAhPT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLmVtaXRWYWx1ZSA9PT0gdHJ1ZSA/IG9wdFZhbHVlIDogb3B0KTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgKHRoaXMuaGFzRGlhbG9nICE9PSB0cnVlIHx8IHRoaXMuZGlhbG9nRmllbGRGb2N1c2VkID09PSB0cnVlKSAmJiB0aGlzLl9fZm9jdXMoKTsKCiAgICAgIHRoaXMuX19zZWxlY3RJbnB1dFRleHQoKTsKCiAgICAgIGlmICh0aGlzLmlubmVyVmFsdWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdmFyIHZhbCA9IHRoaXMuZW1pdFZhbHVlID09PSB0cnVlID8gb3B0VmFsdWUgOiBvcHQ7CiAgICAgICAgdGhpcy4kZW1pdCgnYWRkJywgewogICAgICAgICAgaW5kZXg6IDAsCiAgICAgICAgICB2YWx1ZTogdmFsCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLm11bHRpcGxlID09PSB0cnVlID8gW3ZhbF0gOiB2YWwpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG1vZGVsID0gdGhpcy52YWx1ZS5zbGljZSgpLAogICAgICAgICAgaW5kZXggPSB0aGlzLmlubmVyT3B0aW9uc1ZhbHVlLmZpbmRJbmRleChmdW5jdGlvbiAodikgewogICAgICAgIHJldHVybiBpc0RlZXBFcXVhbCh2LCBvcHRWYWx1ZSk7CiAgICAgIH0pOwoKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICB0aGlzLiRlbWl0KCdyZW1vdmUnLCB7CiAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICB2YWx1ZTogbW9kZWwuc3BsaWNlKGluZGV4LCAxKVswXQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLm1heFZhbHVlcyAhPT0gdm9pZCAwICYmIG1vZGVsLmxlbmd0aCA+PSB0aGlzLm1heFZhbHVlcykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIF92YWwgPSB0aGlzLmVtaXRWYWx1ZSA9PT0gdHJ1ZSA/IG9wdFZhbHVlIDogb3B0OwoKICAgICAgICB0aGlzLiRlbWl0KCdhZGQnLCB7CiAgICAgICAgICBpbmRleDogbW9kZWwubGVuZ3RoLAogICAgICAgICAgdmFsdWU6IF92YWwKICAgICAgICB9KTsKICAgICAgICBtb2RlbC5wdXNoKF92YWwpOwogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIG1vZGVsKTsKICAgIH0sCiAgICBzZXRPcHRpb25JbmRleDogZnVuY3Rpb24gc2V0T3B0aW9uSW5kZXgoaW5kZXgpIHsKICAgICAgaWYgKHRoaXMuJHEucGxhdGZvcm0uaXMuZGVza3RvcCAhPT0gdHJ1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHZhbCA9IGluZGV4ID4gLTEgJiYgaW5kZXggPCB0aGlzLnZpcnR1YWxTY3JvbGxMZW5ndGggPyBpbmRleCA6IC0xOwoKICAgICAgaWYgKHRoaXMub3B0aW9uSW5kZXggIT09IHZhbCkgewogICAgICAgIHRoaXMub3B0aW9uSW5kZXggPSB2YWw7CiAgICAgIH0KICAgIH0sCiAgICBtb3ZlT3B0aW9uU2VsZWN0aW9uOiBmdW5jdGlvbiBtb3ZlT3B0aW9uU2VsZWN0aW9uKCkgewogICAgICB2YXIgb2Zmc2V0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICB2YXIgc2tpcElucHV0VmFsdWUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmICh0aGlzLm1lbnUgPT09IHRydWUpIHsKICAgICAgICB2YXIgaW5kZXggPSB0aGlzLm9wdGlvbkluZGV4OwoKICAgICAgICBkbyB7CiAgICAgICAgICBpbmRleCA9IG5vcm1hbGl6ZVRvSW50ZXJ2YWwoaW5kZXggKyBvZmZzZXQsIC0xLCB0aGlzLnZpcnR1YWxTY3JvbGxMZW5ndGggLSAxKTsKICAgICAgICB9IHdoaWxlIChpbmRleCAhPT0gLTEgJiYgaW5kZXggIT09IHRoaXMub3B0aW9uSW5kZXggJiYgdGhpcy5pc09wdGlvbkRpc2FibGVkKHRoaXMub3B0aW9uc1tpbmRleF0pID09PSB0cnVlKTsKCiAgICAgICAgaWYgKHRoaXMub3B0aW9uSW5kZXggIT09IGluZGV4KSB7CiAgICAgICAgICB0aGlzLnNldE9wdGlvbkluZGV4KGluZGV4KTsKICAgICAgICAgIHRoaXMuc2Nyb2xsVG8oaW5kZXgpOwoKICAgICAgICAgIGlmIChza2lwSW5wdXRWYWx1ZSAhPT0gdHJ1ZSAmJiB0aGlzLnVzZUlucHV0ID09PSB0cnVlICYmIHRoaXMuZmlsbElucHV0ID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMuX19zZXRJbnB1dFZhbHVlKGluZGV4ID49IDAgPyB0aGlzLmdldE9wdGlvbkxhYmVsKHRoaXMub3B0aW9uc1tpbmRleF0pIDogdGhpcy5kZWZhdWx0SW5wdXRWYWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgX19nZXRPcHRpb246IGZ1bmN0aW9uIF9fZ2V0T3B0aW9uKHZhbHVlLCBpbm5lclZhbHVlQ2FjaGUpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB2YXIgZm4gPSBmdW5jdGlvbiBmbihvcHQpIHsKICAgICAgICByZXR1cm4gaXNEZWVwRXF1YWwoX3RoaXM3LmdldE9wdGlvblZhbHVlKG9wdCksIHZhbHVlKTsKICAgICAgfTsKCiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuZmluZChmbikgfHwgaW5uZXJWYWx1ZUNhY2hlLmZpbmQoZm4pIHx8IHZhbHVlOwogICAgfSwKICAgIF9fZ2V0UHJvcFZhbHVlRm46IGZ1bmN0aW9uIF9fZ2V0UHJvcFZhbHVlRm4ocHJvcE5hbWUsIGRlZmF1bHRWYWwpIHsKICAgICAgdmFyIHZhbCA9IHRoaXNbcHJvcE5hbWVdICE9PSB2b2lkIDAgPyB0aGlzW3Byb3BOYW1lXSA6IGRlZmF1bHRWYWw7CiAgICAgIHJldHVybiB0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nID8gdmFsIDogZnVuY3Rpb24gKG9wdCkgewogICAgICAgIHJldHVybiBPYmplY3Qob3B0KSA9PT0gb3B0ICYmIHZhbCBpbiBvcHQgPyBvcHRbdmFsXSA6IG9wdDsKICAgICAgfTsKICAgIH0sCiAgICBpc09wdGlvblNlbGVjdGVkOiBmdW5jdGlvbiBpc09wdGlvblNlbGVjdGVkKG9wdCkgewogICAgICB2YXIgdmFsID0gdGhpcy5nZXRPcHRpb25WYWx1ZShvcHQpOwogICAgICByZXR1cm4gdGhpcy5pbm5lck9wdGlvbnNWYWx1ZS5maW5kKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgcmV0dXJuIGlzRGVlcEVxdWFsKHYsIHZhbCk7CiAgICAgIH0pICE9PSB2b2lkIDA7CiAgICB9LAogICAgX19zZWxlY3RJbnB1dFRleHQ6IGZ1bmN0aW9uIF9fc2VsZWN0SW5wdXRUZXh0KCkgewogICAgICBpZiAodGhpcy51c2VJbnB1dCA9PT0gdHJ1ZSAmJiB0aGlzLiRyZWZzLnRhcmdldCAhPT0gdm9pZCAwKSB7CiAgICAgICAgdGhpcy4kcmVmcy50YXJnZXQuc2VsZWN0KCk7CiAgICAgIH0KICAgIH0sCiAgICBfX29uVGFyZ2V0S2V5dXA6IGZ1bmN0aW9uIF9fb25UYXJnZXRLZXl1cChlKSB7CiAgICAgIC8vIGlmIEVTQyBhbmQgd2UgaGF2ZSBhbiBvcGVuZWQgbWVudQogICAgICAvLyB0aGVuIHN0b3AgcHJvcGFnYXRpb24gKG1pZ2h0IGJlIGNhdWdodCBieSBhIFFEaWFsb2cKICAgICAgLy8gYW5kIHNvIGl0IHdpbGwgYWxzbyBjbG9zZSB0aGUgUURpYWxvZywgd2hpY2ggaXMgd3JvbmcpCiAgICAgIGlmIChpc0tleUNvZGUoZSwgMjcpID09PSB0cnVlICYmIHRoaXMubWVudSA9PT0gdHJ1ZSkgewogICAgICAgIHN0b3AoZSk7IC8vIG9uIEVTQyB3ZSBuZWVkIHRvIGNsb3NlIHRoZSBkaWFsb2cgYWxzbwoKICAgICAgICB0aGlzLmhpZGVQb3B1cCgpOwoKICAgICAgICB0aGlzLl9fcmVzZXRJbnB1dFZhbHVlKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGVtaXQoJ2tleXVwJywgZSk7CiAgICB9LAogICAgX19vblRhcmdldEF1dG9jb21wbGV0ZTogZnVuY3Rpb24gX19vblRhcmdldEF1dG9jb21wbGV0ZShlKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHZhbHVlID0gZS50YXJnZXQudmFsdWU7CiAgICAgIGUudGFyZ2V0LnZhbHVlID0gJyc7CgogICAgICBpZiAoZS5rZXlDb2RlICE9PSB2b2lkIDApIHsKICAgICAgICB0aGlzLl9fb25UYXJnZXRLZXl1cChlKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIG5lZWRsZSA9IHZhbHVlLnRvTG9jYWxlTG93ZXJDYXNlKCk7CgogICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIGZuKG9wdCkgewogICAgICAgICAgcmV0dXJuIF90aGlzOC5nZXRPcHRpb25WYWx1ZShvcHQpLnRvTG9jYWxlTG93ZXJDYXNlKCkgPT09IG5lZWRsZTsKICAgICAgICB9OwoKICAgICAgICB2YXIgb3B0aW9uID0gdGhpcy5vcHRpb25zLmZpbmQoZm4pOwoKICAgICAgICBpZiAob3B0aW9uICE9PSBudWxsKSB7CiAgICAgICAgICB0aGlzLmlubmVyVmFsdWUuaW5kZXhPZihvcHRpb24pID09PSAtMSAmJiB0aGlzLnRvZ2dsZU9wdGlvbihvcHRpb24pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmbiA9IGZ1bmN0aW9uIGZuKG9wdCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXM4LmdldE9wdGlvbkxhYmVsKG9wdCkudG9Mb2NhbGVMb3dlckNhc2UoKSA9PT0gbmVlZGxlOwogICAgICAgICAgfTsKCiAgICAgICAgICBvcHRpb24gPSB0aGlzLm9wdGlvbnMuZmluZChmbik7CgogICAgICAgICAgaWYgKG9wdGlvbiAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLmlubmVyVmFsdWUuaW5kZXhPZihvcHRpb24pID09PSAtMSAmJiB0aGlzLnRvZ2dsZU9wdGlvbihvcHRpb24pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIF9fb25UYXJnZXRLZXlwcmVzczogZnVuY3Rpb24gX19vblRhcmdldEtleXByZXNzKGUpIHsKICAgICAgdGhpcy4kZW1pdCgna2V5cHJlc3MnLCBlKTsKICAgIH0sCiAgICBfX29uVGFyZ2V0S2V5ZG93bjogZnVuY3Rpb24gX19vblRhcmdldEtleWRvd24oZSkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHRoaXMuJGVtaXQoJ2tleWRvd24nLCBlKTsKCiAgICAgIGlmIChzaG91bGRJZ25vcmVLZXkoZSkgPT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBuZXdWYWx1ZU1vZGVWYWxpZCA9IHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPiAwICYmICh0aGlzLm5ld1ZhbHVlTW9kZSAhPT0gdm9pZCAwIHx8IHRoaXMucUxpc3RlbmVyc1snbmV3LXZhbHVlJ10gIT09IHZvaWQgMCk7CiAgICAgIHZhciB0YWJTaG91bGRTZWxlY3QgPSBlLnNoaWZ0S2V5ICE9PSB0cnVlICYmIHRoaXMubXVsdGlwbGUgIT09IHRydWUgJiYgKHRoaXMub3B0aW9uSW5kZXggPiAtMSB8fCBuZXdWYWx1ZU1vZGVWYWxpZCA9PT0gdHJ1ZSk7IC8vIGVzY2FwZQoKICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpIHsKICAgICAgICBwcmV2ZW50KGUpOyAvLyBwcmV2ZW50IGNsZWFyaW5nIHRoZSBpbnB1dFZhbHVlCgogICAgICAgIHJldHVybjsKICAgICAgfSAvLyB0YWIKCgogICAgICBpZiAoZS5rZXlDb2RlID09PSA5ICYmIHRhYlNob3VsZFNlbGVjdCA9PT0gZmFsc2UpIHsKICAgICAgICB0aGlzLl9fY2xvc2VNZW51KCk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGUudGFyZ2V0ID09PSB2b2lkIDAgfHwgZS50YXJnZXQuaWQgIT09IHRoaXMudGFyZ2V0VWlkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIGRvd24KCgogICAgICBpZiAoZS5rZXlDb2RlID09PSA0MCAmJiB0aGlzLmlubmVyTG9hZGluZyAhPT0gdHJ1ZSAmJiB0aGlzLm1lbnUgPT09IGZhbHNlKSB7CiAgICAgICAgc3RvcEFuZFByZXZlbnQoZSk7CiAgICAgICAgdGhpcy5zaG93UG9wdXAoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gYmFja3NwYWNlCgoKICAgICAgaWYgKGUua2V5Q29kZSA9PT0gOCAmJiB0aGlzLm11bHRpcGxlID09PSB0cnVlICYmIHRoaXMuaGlkZVNlbGVjdGVkICE9PSB0cnVlICYmIHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPT09IDAgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlKSkgewogICAgICAgIHRoaXMucmVtb3ZlQXRJbmRleCh0aGlzLnZhbHVlLmxlbmd0aCAtIDEpOwogICAgICAgIHJldHVybjsKICAgICAgfSAvLyB1cCwgZG93bgoKCiAgICAgIGlmIChlLmtleUNvZGUgPT09IDM4IHx8IGUua2V5Q29kZSA9PT0gNDApIHsKICAgICAgICBzdG9wQW5kUHJldmVudChlKTsKICAgICAgICB0aGlzLm1vdmVPcHRpb25TZWxlY3Rpb24oZS5rZXlDb2RlID09PSAzOCA/IC0xIDogMSwgdGhpcy5tdWx0aXBsZSk7CiAgICAgIH0KCiAgICAgIHZhciBvcHRpb25zTGVuZ3RoID0gdGhpcy52aXJ0dWFsU2Nyb2xsTGVuZ3RoOyAvLyBjbGVhciBzZWFyY2ggYnVmZmVyIGlmIGV4cGlyZWQKCiAgICAgIGlmICh0aGlzLnNlYXJjaEJ1ZmZlciA9PT0gdm9pZCAwIHx8IHRoaXMuc2VhcmNoQnVmZmVyRXhwIDwgRGF0ZS5ub3coKSkgewogICAgICAgIHRoaXMuc2VhcmNoQnVmZmVyID0gJyc7CiAgICAgIH0gLy8ga2V5Ym9hcmQgc2VhcmNoIHdoZW4gbm90IGhhdmluZyB1c2UtaW5wdXQKCgogICAgICBpZiAob3B0aW9uc0xlbmd0aCA+IDAgJiYgdGhpcy51c2VJbnB1dCAhPT0gdHJ1ZSAmJiBlLmtleS5sZW5ndGggPT09IDEgJiYgLy8gcHJpbnRhYmxlIGNoYXIKICAgICAgZS5hbHRLZXkgPT09IGUuY3RybEtleSAmJiAoIC8vIG5vdCBrYmQgc2hvcnRjdXQKICAgICAgZS5rZXlDb2RlICE9PSAzMiB8fCB0aGlzLnNlYXJjaEJ1ZmZlci5sZW5ndGggPiAwKSAvLyBzcGFjZSBpbiBtaWRkbGUgb2Ygc2VhcmNoCiAgICAgICkgewogICAgICAgICAgdGhpcy5tZW51ICE9PSB0cnVlICYmIHRoaXMuc2hvd1BvcHVwKGUpOwoKICAgICAgICAgIHZhciBfY2hhciA9IGUua2V5LnRvTG9jYWxlTG93ZXJDYXNlKCksCiAgICAgICAgICAgICAga2V5UmVwZWF0ID0gdGhpcy5zZWFyY2hCdWZmZXIubGVuZ3RoID09PSAxICYmIHRoaXMuc2VhcmNoQnVmZmVyWzBdID09PSBfY2hhcjsKCiAgICAgICAgICB0aGlzLnNlYXJjaEJ1ZmZlckV4cCA9IERhdGUubm93KCkgKyAxNTAwOwoKICAgICAgICAgIGlmIChrZXlSZXBlYXQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHN0b3BBbmRQcmV2ZW50KGUpOwogICAgICAgICAgICB0aGlzLnNlYXJjaEJ1ZmZlciArPSBfY2hhcjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgc2VhcmNoUmUgPSBuZXcgUmVnRXhwKCdeJyArIHRoaXMuc2VhcmNoQnVmZmVyLnNwbGl0KCcnKS5tYXAoZnVuY3Rpb24gKGwpIHsKICAgICAgICAgICAgcmV0dXJuIHJlRXNjYXBlTGlzdC5pbmRleE9mKGwpID4gLTEgPyAnXFwnICsgbCA6IGw7CiAgICAgICAgICB9KS5qb2luKCcuKicpLCAnaScpOwogICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5vcHRpb25JbmRleDsKCiAgICAgICAgICBpZiAoa2V5UmVwZWF0ID09PSB0cnVlIHx8IGluZGV4IDwgMCB8fCBzZWFyY2hSZS50ZXN0KHRoaXMuZ2V0T3B0aW9uTGFiZWwodGhpcy5vcHRpb25zW2luZGV4XSkpICE9PSB0cnVlKSB7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICBpbmRleCA9IG5vcm1hbGl6ZVRvSW50ZXJ2YWwoaW5kZXggKyAxLCAtMSwgb3B0aW9uc0xlbmd0aCAtIDEpOwogICAgICAgICAgICB9IHdoaWxlIChpbmRleCAhPT0gdGhpcy5vcHRpb25JbmRleCAmJiAodGhpcy5pc09wdGlvbkRpc2FibGVkKHRoaXMub3B0aW9uc1tpbmRleF0pID09PSB0cnVlIHx8IHNlYXJjaFJlLnRlc3QodGhpcy5nZXRPcHRpb25MYWJlbCh0aGlzLm9wdGlvbnNbaW5kZXhdKSkgIT09IHRydWUpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5vcHRpb25JbmRleCAhPT0gaW5kZXgpIHsKICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIF90aGlzOS5zZXRPcHRpb25JbmRleChpbmRleCk7CgogICAgICAgICAgICAgIF90aGlzOS5zY3JvbGxUbyhpbmRleCk7CgogICAgICAgICAgICAgIGlmIChpbmRleCA+PSAwICYmIF90aGlzOS51c2VJbnB1dCA9PT0gdHJ1ZSAmJiBfdGhpczkuZmlsbElucHV0ID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICBfdGhpczkuX19zZXRJbnB1dFZhbHVlKF90aGlzOS5nZXRPcHRpb25MYWJlbChfdGhpczkub3B0aW9uc1tpbmRleF0pKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIGVudGVyLCBzcGFjZSAod2hlbiBub3QgdXNpbmcgdXNlLWlucHV0IGFuZCBub3QgaW4gc2VhcmNoKSwgb3IgdGFiICh3aGVuIG5vdCB1c2luZyBtdWx0aXBsZSBhbmQgb3B0aW9uIHNlbGVjdGVkKQogICAgICAvLyBzYW1lIHRhcmdldCBpcyBjaGVja2VkIGFib3ZlCgoKICAgICAgaWYgKGUua2V5Q29kZSAhPT0gMTMgJiYgKGUua2V5Q29kZSAhPT0gMzIgfHwgdGhpcy51c2VJbnB1dCA9PT0gdHJ1ZSB8fCB0aGlzLnNlYXJjaEJ1ZmZlciAhPT0gJycpICYmIChlLmtleUNvZGUgIT09IDkgfHwgdGFiU2hvdWxkU2VsZWN0ID09PSBmYWxzZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGUua2V5Q29kZSAhPT0gOSAmJiBzdG9wQW5kUHJldmVudChlKTsKCiAgICAgIGlmICh0aGlzLm9wdGlvbkluZGV4ID4gLTEgJiYgdGhpcy5vcHRpb25JbmRleCA8IG9wdGlvbnNMZW5ndGgpIHsKICAgICAgICB0aGlzLnRvZ2dsZU9wdGlvbih0aGlzLm9wdGlvbnNbdGhpcy5vcHRpb25JbmRleF0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKG5ld1ZhbHVlTW9kZVZhbGlkID09PSB0cnVlKSB7CiAgICAgICAgdmFyIGRvbmUgPSBmdW5jdGlvbiBkb25lKHZhbCwgbW9kZSkgewogICAgICAgICAgaWYgKG1vZGUpIHsKICAgICAgICAgICAgaWYgKHZhbGlkYXRlTmV3VmFsdWVNb2RlKG1vZGUpICE9PSB0cnVlKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtb2RlID0gX3RoaXM5Lm5ld1ZhbHVlTW9kZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodmFsID09PSB2b2lkIDAgfHwgdmFsID09PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczkudXBkYXRlSW5wdXRWYWx1ZSgnJywgX3RoaXM5Lm11bHRpcGxlICE9PSB0cnVlLCB0cnVlKTsKCiAgICAgICAgICBfdGhpczlbbW9kZSA9PT0gJ3RvZ2dsZScgPyAndG9nZ2xlT3B0aW9uJyA6ICdhZGQnXSh2YWwsIG1vZGUgPT09ICdhZGQtdW5pcXVlJyk7CgogICAgICAgICAgaWYgKF90aGlzOS5tdWx0aXBsZSAhPT0gdHJ1ZSkgewogICAgICAgICAgICBfdGhpczkuJHJlZnMudGFyZ2V0ICE9PSB2b2lkIDAgJiYgX3RoaXM5LiRyZWZzLnRhcmdldC5mb2N1cygpOwoKICAgICAgICAgICAgX3RoaXM5LmhpZGVQb3B1cCgpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGlmICh0aGlzLnFMaXN0ZW5lcnNbJ25ldy12YWx1ZSddICE9PSB2b2lkIDApIHsKICAgICAgICAgIHRoaXMuJGVtaXQoJ25ldy12YWx1ZScsIHRoaXMuaW5wdXRWYWx1ZSwgZG9uZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRvbmUodGhpcy5pbnB1dFZhbHVlKTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm11bHRpcGxlICE9PSB0cnVlKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5tZW51ID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy5fX2Nsb3NlTWVudSgpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaW5uZXJMb2FkaW5nICE9PSB0cnVlKSB7CiAgICAgICAgdGhpcy5zaG93UG9wdXAoKTsKICAgICAgfQogICAgfSwKICAgIF9fZ2V0VmlydHVhbFNjcm9sbEVsOiBmdW5jdGlvbiBfX2dldFZpcnR1YWxTY3JvbGxFbCgpIHsKICAgICAgcmV0dXJuIHRoaXMuaGFzRGlhbG9nID09PSB0cnVlID8gdGhpcy4kcmVmcy5tZW51Q29udGVudCA6IHRoaXMuJHJlZnMubWVudSAhPT0gdm9pZCAwICYmIHRoaXMuJHJlZnMubWVudS5fX3BvcnRhbCAhPT0gdm9pZCAwID8gdGhpcy4kcmVmcy5tZW51Ll9fcG9ydGFsLiRlbCA6IHZvaWQgMDsKICAgIH0sCiAgICBfX2dldFZpcnR1YWxTY3JvbGxUYXJnZXQ6IGZ1bmN0aW9uIF9fZ2V0VmlydHVhbFNjcm9sbFRhcmdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX19nZXRWaXJ0dWFsU2Nyb2xsRWwoKTsKICAgIH0sCiAgICBfX2dldFNlbGVjdGlvbjogZnVuY3Rpb24gX19nZXRTZWxlY3Rpb24oaCwgZnJvbURpYWxvZykgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5oaWRlU2VsZWN0ZWQgPT09IHRydWUpIHsKICAgICAgICByZXR1cm4gZnJvbURpYWxvZyA9PT0gdHJ1ZSB8fCB0aGlzLmRpYWxvZyAhPT0gdHJ1ZSB8fCB0aGlzLmhhc0RpYWxvZyAhPT0gdHJ1ZSA/IFtdIDogW2goJ3NwYW4nLCB7CiAgICAgICAgICBkb21Qcm9wczogewogICAgICAgICAgICB0ZXh0Q29udGVudDogdGhpcy5pbnB1dFZhbHVlCiAgICAgICAgICB9CiAgICAgICAgfSldOwogICAgICB9CgogICAgICBpZiAodGhpcy4kc2NvcGVkU2xvdHNbJ3NlbGVjdGVkLWl0ZW0nXSAhPT0gdm9pZCAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRTY29wZS5tYXAoZnVuY3Rpb24gKHNjb3BlKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMxMC4kc2NvcGVkU2xvdHNbJ3NlbGVjdGVkLWl0ZW0nXShzY29wZSk7CiAgICAgICAgfSkuc2xpY2UoKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuJHNjb3BlZFNsb3RzLnNlbGVjdGVkICE9PSB2b2lkIDApIHsKICAgICAgICByZXR1cm4gdGhpcy4kc2NvcGVkU2xvdHMuc2VsZWN0ZWQoKS5zbGljZSgpOwogICAgICB9CgogICAgICBpZiAodGhpcy51c2VDaGlwcyA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkU2NvcGUubWFwKGZ1bmN0aW9uIChzY29wZSwgaSkgewogICAgICAgICAgcmV0dXJuIGgoUUNoaXAsIHsKICAgICAgICAgICAga2V5OiAnb3B0aW9uLScgKyBpLAogICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgIHJlbW92YWJsZTogX3RoaXMxMC5lZGl0YWJsZSA9PT0gdHJ1ZSAmJiBfdGhpczEwLmlzT3B0aW9uRGlzYWJsZWQoc2NvcGUub3B0KSAhPT0gdHJ1ZSwKICAgICAgICAgICAgICBkZW5zZTogdHJ1ZSwKICAgICAgICAgICAgICB0ZXh0Q29sb3I6IF90aGlzMTAuY29sb3IsCiAgICAgICAgICAgICAgdGFiaW5kZXg6IF90aGlzMTAuY29tcHV0ZWRUYWJpbmRleAogICAgICAgICAgICB9LAogICAgICAgICAgICBvbjogY2FjaGUoX3RoaXMxMCwgJ3JlbSMnICsgaSwgewogICAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkgewogICAgICAgICAgICAgICAgc2NvcGUucmVtb3ZlQXRJbmRleChpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9LCBbaCgnc3BhbicsIHsKICAgICAgICAgICAgc3RhdGljQ2xhc3M6ICdlbGxpcHNpcycsCiAgICAgICAgICAgIGRvbVByb3BzOiBfZGVmaW5lUHJvcGVydHkoe30sIHNjb3BlLnNhbml0aXplID09PSB0cnVlID8gJ3RleHRDb250ZW50JyA6ICdpbm5lckhUTUwnLCBfdGhpczEwLmdldE9wdGlvbkxhYmVsKHNjb3BlLm9wdCkpCiAgICAgICAgICB9KV0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gW2goJ3NwYW4nLCB7CiAgICAgICAgZG9tUHJvcHM6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgdGhpcy5kaXNwbGF5QXNUZXh0ID8gJ3RleHRDb250ZW50JyA6ICdpbm5lckhUTUwnLCB0aGlzLmRpc3BsYXlWYWx1ZSAhPT0gdm9pZCAwID8gdGhpcy5kaXNwbGF5VmFsdWUgOiB0aGlzLnNlbGVjdGVkU3RyaW5nKQogICAgICB9KV07CiAgICB9LAogICAgX19nZXRDb250cm9sOiBmdW5jdGlvbiBfX2dldENvbnRyb2woaCwgZnJvbURpYWxvZykgewogICAgICB2YXIgY2hpbGQgPSB0aGlzLl9fZ2V0U2VsZWN0aW9uKGgsIGZyb21EaWFsb2cpOwoKICAgICAgdmFyIGlzVGFyZ2V0ID0gZnJvbURpYWxvZyA9PT0gdHJ1ZSB8fCB0aGlzLmRpYWxvZyAhPT0gdHJ1ZSB8fCB0aGlzLmhhc0RpYWxvZyAhPT0gdHJ1ZTsKCiAgICAgIGlmIChpc1RhcmdldCA9PT0gdHJ1ZSAmJiB0aGlzLnVzZUlucHV0ID09PSB0cnVlKSB7CiAgICAgICAgY2hpbGQucHVzaCh0aGlzLl9fZ2V0SW5wdXQoaCwgZnJvbURpYWxvZykpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZWRpdGFibGUgPT09IHRydWUpIHsKICAgICAgICBpc1RhcmdldCA9PT0gdHJ1ZSAmJiBjaGlsZC5wdXNoKGgoJ2RpdicsIHsKICAgICAgICAgIC8vIHRoZXJlIGNhbiBiZSBvbmx5IG9uZSAod2hlbiBkaWFsb2cgaXMgb3BlbmVkIHRoZSBjb250cm9sIGluIGRpYWxvZyBzaG91bGQgYmUgdGFyZ2V0KQogICAgICAgICAgcmVmOiAndGFyZ2V0JywKICAgICAgICAgIGtleTogJ2RfdCcsCiAgICAgICAgICBzdGF0aWNDbGFzczogJ25vLW91dGxpbmUnLAogICAgICAgICAgYXR0cnM6IHsKICAgICAgICAgICAgaWQ6IHRoaXMudGFyZ2V0VWlkLAogICAgICAgICAgICB0YWJpbmRleDogdGhpcy50YWJpbmRleAogICAgICAgICAgfSwKICAgICAgICAgIG9uOiBjYWNoZSh0aGlzLCAnZi10Z2V0JywgewogICAgICAgICAgICBrZXlkb3duOiB0aGlzLl9fb25UYXJnZXRLZXlkb3duLAogICAgICAgICAgICBrZXl1cDogdGhpcy5fX29uVGFyZ2V0S2V5dXAsCiAgICAgICAgICAgIGtleXByZXNzOiB0aGlzLl9fb25UYXJnZXRLZXlwcmVzcwogICAgICAgICAgfSkKICAgICAgICB9KSk7CiAgICAgICAgdGhpcy5xQXR0cnMuYXV0b2NvbXBsZXRlICE9PSB2b2lkIDAgJiYgY2hpbGQucHVzaChoKCdpbnB1dCcsIHsKICAgICAgICAgIHN0YXRpY0NsYXNzOiAncS1zZWxlY3RfX2F1dG9jb21wbGV0ZS1pbnB1dCBuby1vdXRsaW5lJywKICAgICAgICAgIGF0dHJzOiB7CiAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogdGhpcy5xQXR0cnMuYXV0b2NvbXBsZXRlCiAgICAgICAgICB9LAogICAgICAgICAgb246IGNhY2hlKHRoaXMsICdhdXRvaW5wJywgewogICAgICAgICAgICBrZXl1cDogdGhpcy5fX29uVGFyZ2V0QXV0b2NvbXBsZXRlCiAgICAgICAgICB9KQogICAgICAgIH0pKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubmFtZVByb3AgIT09IHZvaWQgMCAmJiB0aGlzLmRpc2FibGUgIT09IHRydWUgJiYgdGhpcy5pbm5lck9wdGlvbnNWYWx1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIG9wdHMgPSB0aGlzLmlubmVyT3B0aW9uc1ZhbHVlLm1hcChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIHJldHVybiBoKCdvcHRpb24nLCB7CiAgICAgICAgICAgIGF0dHJzOiB7CiAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgICAgIHNlbGVjdGVkOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIGNoaWxkLnB1c2goaCgnc2VsZWN0JywgewogICAgICAgICAgc3RhdGljQ2xhc3M6ICdoaWRkZW4nLAogICAgICAgICAgYXR0cnM6IHsKICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lUHJvcCwKICAgICAgICAgICAgbXVsdGlwbGU6IHRoaXMubXVsdGlwbGUKICAgICAgICAgIH0KICAgICAgICB9LCBvcHRzKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBoKCdkaXYnLCB7CiAgICAgICAgc3RhdGljQ2xhc3M6ICdxLWZpZWxkX19uYXRpdmUgcm93IGl0ZW1zLWNlbnRlcicsCiAgICAgICAgYXR0cnM6IHRoaXMucUF0dHJzCiAgICAgIH0sIGNoaWxkKTsKICAgIH0sCiAgICBfX2dldE9wdGlvbnM6IGZ1bmN0aW9uIF9fZ2V0T3B0aW9ucyhoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIGlmICh0aGlzLm1lbnUgIT09IHRydWUpIHsKICAgICAgICByZXR1cm4gdm9pZCAwOwogICAgICB9CgogICAgICB2YXIgZm4gPSB0aGlzLiRzY29wZWRTbG90cy5vcHRpb24gIT09IHZvaWQgMCA/IHRoaXMuJHNjb3BlZFNsb3RzLm9wdGlvbiA6IGZ1bmN0aW9uIChzY29wZSkgewogICAgICAgIHJldHVybiBoKFFJdGVtLCB7CiAgICAgICAgICBrZXk6IHNjb3BlLmluZGV4LAogICAgICAgICAgcHJvcHM6IHNjb3BlLml0ZW1Qcm9wcywKICAgICAgICAgIG9uOiBzY29wZS5pdGVtRXZlbnRzCiAgICAgICAgfSwgW2goUUl0ZW1TZWN0aW9uLCBbaChRSXRlbUxhYmVsLCB7CiAgICAgICAgICBkb21Qcm9wczogX2RlZmluZVByb3BlcnR5KHt9LCBzY29wZS5zYW5pdGl6ZSA9PT0gdHJ1ZSA/ICd0ZXh0Q29udGVudCcgOiAnaW5uZXJIVE1MJywgX3RoaXMxMS5nZXRPcHRpb25MYWJlbChzY29wZS5vcHQpKQogICAgICAgIH0pXSldKTsKICAgICAgfTsKCiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5fX3BhZFZpcnR1YWxTY3JvbGwoaCwgJ2RpdicsIHRoaXMub3B0aW9uU2NvcGUubWFwKGZuKSk7CgogICAgICBpZiAodGhpcy4kc2NvcGVkU2xvdHNbJ2JlZm9yZS1vcHRpb25zJ10gIT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB0aGlzLiRzY29wZWRTbG90c1snYmVmb3JlLW9wdGlvbnMnXSgpLmNvbmNhdChvcHRpb25zKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG1lcmdlU2xvdChvcHRpb25zLCB0aGlzLCAnYWZ0ZXItb3B0aW9ucycpOwogICAgfSwKICAgIF9fZ2V0SW5uZXJBcHBlbmQ6IGZ1bmN0aW9uIF9fZ2V0SW5uZXJBcHBlbmQoaCkgewogICAgICByZXR1cm4gdGhpcy5sb2FkaW5nICE9PSB0cnVlICYmIHRoaXMuaW5uZXJMb2FkaW5nICE9PSB0cnVlICYmIHRoaXMuaGlkZURyb3Bkb3duSWNvbiAhPT0gdHJ1ZSA/IFtoKFFJY29uLCB7CiAgICAgICAgc3RhdGljQ2xhc3M6ICdxLXNlbGVjdF9fZHJvcGRvd24taWNvbicsCiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIG5hbWU6IHRoaXMuZHJvcGRvd25BcnJvd0ljb24KICAgICAgICB9CiAgICAgIH0pXSA6IG51bGw7CiAgICB9LAogICAgX19nZXRJbnB1dDogZnVuY3Rpb24gX19nZXRJbnB1dChoLCBmcm9tRGlhbG9nKSB7CiAgICAgIHZhciBvcHRpb25zID0gewogICAgICAgIHJlZjogJ3RhcmdldCcsCiAgICAgICAga2V5OiAnaV90JywKICAgICAgICBzdGF0aWNDbGFzczogJ3EtZmllbGRfX2lucHV0IHEtcGxhY2Vob2xkZXIgY29sJywKICAgICAgICBzdHlsZTogdGhpcy5pbnB1dFN0eWxlLAogICAgICAgICJjbGFzcyI6IHRoaXMuY29tcHV0ZWRJbnB1dENsYXNzLAogICAgICAgIGRvbVByb3BzOiB7CiAgICAgICAgICB2YWx1ZTogdGhpcy5pbnB1dFZhbHVlICE9PSB2b2lkIDAgPyB0aGlzLmlucHV0VmFsdWUgOiAnJwogICAgICAgIH0sCiAgICAgICAgYXR0cnM6IF9vYmplY3RTcHJlYWQoewogICAgICAgICAgLy8gcmVxdWlyZWQgZm9yIEFuZHJvaWQgaW4gb3JkZXIgdG8gc2hvdyBFTlRFUiBrZXkgd2hlbiBpbiBmb3JtCiAgICAgICAgICB0eXBlOiAnc2VhcmNoJwogICAgICAgIH0sIHRoaXMucUF0dHJzLCB7CiAgICAgICAgICBpZDogdGhpcy50YXJnZXRVaWQsCiAgICAgICAgICBtYXhsZW5ndGg6IHRoaXMubWF4bGVuZ3RoLAogICAgICAgICAgLy8gdGhpcyBpcyBjb252ZXJ0ZWQgdG8gcHJvcCBieSBRRmllbGQKICAgICAgICAgIHRhYmluZGV4OiB0aGlzLnRhYmluZGV4LAogICAgICAgICAgJ2RhdGEtYXV0b2ZvY3VzJzogZnJvbURpYWxvZyA9PT0gdHJ1ZSA/IGZhbHNlIDogdGhpcy5hdXRvZm9jdXMsCiAgICAgICAgICBkaXNhYmxlZDogdGhpcy5kaXNhYmxlID09PSB0cnVlLAogICAgICAgICAgcmVhZG9ubHk6IHRoaXMucmVhZG9ubHkgPT09IHRydWUKICAgICAgICB9KSwKICAgICAgICBvbjogdGhpcy5pbnB1dENvbnRyb2xFdmVudHMKICAgICAgfTsKCiAgICAgIGlmIChmcm9tRGlhbG9nICE9PSB0cnVlICYmIHRoaXMuaGFzRGlhbG9nID09PSB0cnVlKSB7CiAgICAgICAgb3B0aW9ucy5zdGF0aWNDbGFzcyArPSAnIG5vLXBvaW50ZXItZXZlbnRzJzsKICAgICAgICBvcHRpb25zLmF0dHJzLnJlYWRvbmx5ID0gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGgoJ2lucHV0Jywgb3B0aW9ucyk7CiAgICB9LAogICAgX19vbkNoYW5nZTogZnVuY3Rpb24gX19vbkNoYW5nZShlKSB7CiAgICAgIHRoaXMuX19vbkNvbXBvc2l0aW9uKGUpOwogICAgfSwKICAgIF9fb25JbnB1dDogZnVuY3Rpb24gX19vbklucHV0KGUpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuaW5wdXRUaW1lcik7CgogICAgICBpZiAoZSAmJiBlLnRhcmdldCAmJiBlLnRhcmdldC5jb21wb3NpbmcgPT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX19zZXRJbnB1dFZhbHVlKGUudGFyZ2V0LnZhbHVlIHx8ICcnKTsgLy8gbWFyayBpdCBoZXJlIGFzIHVzZXIgaW5wdXQgc28gdGhhdCBpZiB1cGRhdGVJbnB1dFZhbHVlIGlzIGNhbGxlZAogICAgICAvLyBiZWZvcmUgZmlsdGVyIGlzIGNhbGxlZCB0aGUgaW5kaWNhdG9yIGlzIHJlc2V0CgoKICAgICAgdGhpcy51c2VySW5wdXRWYWx1ZSA9IHRydWU7CiAgICAgIHRoaXMuZGVmYXVsdElucHV0VmFsdWUgPSB0aGlzLmlucHV0VmFsdWU7CgogICAgICBpZiAodGhpcy5mb2N1c2VkICE9PSB0cnVlICYmICh0aGlzLmhhc0RpYWxvZyAhPT0gdHJ1ZSB8fCB0aGlzLmRpYWxvZ0ZpZWxkRm9jdXNlZCA9PT0gdHJ1ZSkpIHsKICAgICAgICB0aGlzLl9fZm9jdXMoKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucUxpc3RlbmVycy5maWx0ZXIgIT09IHZvaWQgMCkgewogICAgICAgIHRoaXMuaW5wdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMxMi5maWx0ZXIoX3RoaXMxMi5pbnB1dFZhbHVlKTsKICAgICAgICB9LCB0aGlzLmlucHV0RGVib3VuY2UpOwogICAgICB9CiAgICB9LAogICAgX19zZXRJbnB1dFZhbHVlOiBmdW5jdGlvbiBfX3NldElucHV0VmFsdWUoaW5wdXRWYWx1ZSkgewogICAgICBpZiAodGhpcy5pbnB1dFZhbHVlICE9PSBpbnB1dFZhbHVlKSB7CiAgICAgICAgdGhpcy5pbnB1dFZhbHVlID0gaW5wdXRWYWx1ZTsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dC12YWx1ZScsIGlucHV0VmFsdWUpOwogICAgICB9CiAgICB9LAogICAgdXBkYXRlSW5wdXRWYWx1ZTogZnVuY3Rpb24gdXBkYXRlSW5wdXRWYWx1ZSh2YWwsIG5vRmlsdGVyaW5nLCBpbnRlcm5hbCkgewogICAgICB0aGlzLnVzZXJJbnB1dFZhbHVlID0gaW50ZXJuYWwgIT09IHRydWU7CgogICAgICBpZiAodGhpcy51c2VJbnB1dCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuX19zZXRJbnB1dFZhbHVlKHZhbCk7CgogICAgICAgIGlmIChub0ZpbHRlcmluZyA9PT0gdHJ1ZSB8fCBpbnRlcm5hbCAhPT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy5kZWZhdWx0SW5wdXRWYWx1ZSA9IHZhbDsKICAgICAgICB9CgogICAgICAgIG5vRmlsdGVyaW5nICE9PSB0cnVlICYmIHRoaXMuZmlsdGVyKHZhbCk7CiAgICAgIH0KICAgIH0sCiAgICBmaWx0ZXI6IGZ1bmN0aW9uIGZpbHRlcih2YWwpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMucUxpc3RlbmVycy5maWx0ZXIgPT09IHZvaWQgMCB8fCB0aGlzLmZvY3VzZWQgIT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlubmVyTG9hZGluZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJGVtaXQoJ2ZpbHRlci1hYm9ydCcpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW5uZXJMb2FkaW5nID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHZhbCAhPT0gJycgJiYgdGhpcy5tdWx0aXBsZSAhPT0gdHJ1ZSAmJiB0aGlzLmlubmVyVmFsdWUubGVuZ3RoID4gMCAmJiB0aGlzLnVzZXJJbnB1dFZhbHVlICE9PSB0cnVlICYmIHZhbCA9PT0gdGhpcy5nZXRPcHRpb25MYWJlbCh0aGlzLmlubmVyVmFsdWVbMF0pKSB7CiAgICAgICAgdmFsID0gJyc7CiAgICAgIH0KCiAgICAgIHZhciBmaWx0ZXJJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMTMubWVudSA9PT0gdHJ1ZSAmJiAoX3RoaXMxMy5tZW51ID0gZmFsc2UpOwogICAgICB9LCAxMCk7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLmZpbHRlcklkKTsKICAgICAgdGhpcy5maWx0ZXJJZCA9IGZpbHRlcklkOwogICAgICB0aGlzLiRlbWl0KCdmaWx0ZXInLCB2YWwsIGZ1bmN0aW9uIChmbiwgYWZ0ZXJGbikgewogICAgICAgIGlmIChfdGhpczEzLmZvY3VzZWQgPT09IHRydWUgJiYgX3RoaXMxMy5maWx0ZXJJZCA9PT0gZmlsdGVySWQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChfdGhpczEzLmZpbHRlcklkKTsKICAgICAgICAgIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyAmJiBmbigpOwoKICAgICAgICAgIF90aGlzMTMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMxMy5pbm5lckxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmIChfdGhpczEzLmVkaXRhYmxlID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgaWYgKF90aGlzMTMubWVudSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgX3RoaXMxMy5fX3VwZGF0ZU1lbnUodHJ1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzMTMubWVudSA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB0eXBlb2YgYWZ0ZXJGbiA9PT0gJ2Z1bmN0aW9uJyAmJiBfdGhpczEzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgYWZ0ZXJGbihfdGhpczEzKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoX3RoaXMxMy5mb2N1c2VkID09PSB0cnVlICYmIF90aGlzMTMuZmlsdGVySWQgPT09IGZpbHRlcklkKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMxMy5maWx0ZXJJZCk7CiAgICAgICAgICBfdGhpczEzLmlubmVyTG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMxMy5tZW51ID09PSB0cnVlICYmIChfdGhpczEzLm1lbnUgPSBmYWxzZSk7CiAgICAgIH0pOwogICAgfSwKICAgIF9fZ2V0Q29udHJvbEV2ZW50czogZnVuY3Rpb24gX19nZXRDb250cm9sRXZlbnRzKCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICB2YXIgZm9jdXNvdXQgPSBmdW5jdGlvbiBmb2N1c291dChlKSB7CiAgICAgICAgX3RoaXMxNC5fX29uQ29udHJvbEZvY3Vzb3V0KGUsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMTQuX19yZXNldElucHV0VmFsdWUoKTsKCiAgICAgICAgICBfdGhpczE0Ll9fY2xvc2VNZW51KCk7CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICByZXR1cm4gewogICAgICAgIGZvY3VzaW46IHRoaXMuX19vbkNvbnRyb2xGb2N1c2luLAogICAgICAgIGZvY3Vzb3V0OiBmb2N1c291dCwKICAgICAgICAncG9wdXAtc2hvdyc6IHRoaXMuX19vbkNvbnRyb2xQb3B1cFNob3csCiAgICAgICAgJ3BvcHVwLWhpZGUnOiBmdW5jdGlvbiBwb3B1cEhpZGUoZSkgewogICAgICAgICAgZSAhPT0gdm9pZCAwICYmIHN0b3AoZSk7CgogICAgICAgICAgX3RoaXMxNC4kZW1pdCgncG9wdXAtaGlkZScsIGUpOwoKICAgICAgICAgIF90aGlzMTQuaGFzUG9wdXBPcGVuID0gZmFsc2U7CiAgICAgICAgICBmb2N1c291dChlKTsKICAgICAgICB9LAogICAgICAgIGNsaWNrOiBmdW5jdGlvbiBjbGljayhlKSB7CiAgICAgICAgICBpZiAoX3RoaXMxNC5oYXNEaWFsb2cgIT09IHRydWUpIHsKICAgICAgICAgICAgLy8gbGFiZWwgZnJvbSBRRmllbGQgd2lsbCBwcm9wYWdhdGUgY2xpY2sgb24gdGhlIGlucHV0IChleGNlcHQgSUUpCiAgICAgICAgICAgIGlmIChfdGhpczE0LnVzZUlucHV0ID09PSB0cnVlICYmIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncS1maWVsZF9faW5wdXQnKSAhPT0gdHJ1ZSB8fCBfdGhpczE0LnVzZUlucHV0ICE9PSB0cnVlICYmIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbm8tb3V0bGluZScpID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoX3RoaXMxNC5tZW51ID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgX3RoaXMxNC5fX2Nsb3NlTWVudSgpOwoKICAgICAgICAgICAgICBfdGhpczE0LiRyZWZzLnRhcmdldCAhPT0gdm9pZCAwICYmIF90aGlzMTQuJHJlZnMudGFyZ2V0LmZvY3VzKCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgX3RoaXMxNC5zaG93UG9wdXAoZSk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwKICAgIF9fZ2V0Q29udHJvbENoaWxkOiBmdW5jdGlvbiBfX2dldENvbnRyb2xDaGlsZChoKSB7CiAgICAgIGlmICh0aGlzLmVkaXRhYmxlICE9PSBmYWxzZSAmJiAodGhpcy5kaWFsb2cgPT09IHRydWUgfHwgLy8gZGlhbG9nIGFsd2F5cyBoYXMgbWVudSBkaXNwbGF5ZWQsIHNvIG5lZWQgdG8gcmVuZGVyIGl0CiAgICAgIHRoaXMubm9PcHRpb25zICE9PSB0cnVlIHx8IHRoaXMuJHNjb3BlZFNsb3RzWyduby1vcHRpb24nXSAhPT0gdm9pZCAwKSkgewogICAgICAgIHJldHVybiB0aGlzWyJfX2dldCIuY29uY2F0KHRoaXMuaGFzRGlhbG9nID09PSB0cnVlID8gJ0RpYWxvZycgOiAnTWVudScpXShoKTsKICAgICAgfQogICAgfSwKICAgIF9fZ2V0TWVudTogZnVuY3Rpb24gX19nZXRNZW51KGgpIHsKICAgICAgdmFyIGNoaWxkID0gdGhpcy5ub09wdGlvbnMgPT09IHRydWUgPyB0aGlzLiRzY29wZWRTbG90c1snbm8tb3B0aW9uJ10gIT09IHZvaWQgMCA/IHRoaXMuJHNjb3BlZFNsb3RzWyduby1vcHRpb24nXSh7CiAgICAgICAgaW5wdXRWYWx1ZTogdGhpcy5pbnB1dFZhbHVlCiAgICAgIH0pIDogbnVsbCA6IHRoaXMuX19nZXRPcHRpb25zKGgpOwogICAgICByZXR1cm4gaChRTWVudSwgewogICAgICAgIHJlZjogJ21lbnUnLAogICAgICAgIHByb3BzOiB7CiAgICAgICAgICB2YWx1ZTogdGhpcy5tZW51LAogICAgICAgICAgZml0OiB0aGlzLm1lbnVTaHJpbmsgIT09IHRydWUsCiAgICAgICAgICBjb3ZlcjogdGhpcy5vcHRpb25zQ292ZXIgPT09IHRydWUgJiYgdGhpcy5ub09wdGlvbnMgIT09IHRydWUgJiYgdGhpcy51c2VJbnB1dCAhPT0gdHJ1ZSwKICAgICAgICAgIGFuY2hvcjogdGhpcy5tZW51QW5jaG9yLAogICAgICAgICAgc2VsZjogdGhpcy5tZW51U2VsZiwKICAgICAgICAgIG9mZnNldDogdGhpcy5tZW51T2Zmc2V0LAogICAgICAgICAgY29udGVudENsYXNzOiB0aGlzLm1lbnVDb250ZW50Q2xhc3MsCiAgICAgICAgICBjb250ZW50U3R5bGU6IHRoaXMucG9wdXBDb250ZW50U3R5bGUsCiAgICAgICAgICBkYXJrOiB0aGlzLmlzT3B0aW9uc0RhcmssCiAgICAgICAgICBub1BhcmVudEV2ZW50OiB0cnVlLAogICAgICAgICAgbm9SZWZvY3VzOiB0cnVlLAogICAgICAgICAgbm9Gb2N1czogdHJ1ZSwKICAgICAgICAgIHNxdWFyZTogdGhpcy5zcXVhcmVkTWVudSwKICAgICAgICAgIHRyYW5zaXRpb25TaG93OiB0aGlzLnRyYW5zaXRpb25TaG93LAogICAgICAgICAgdHJhbnNpdGlvbkhpZGU6IHRoaXMudHJhbnNpdGlvbkhpZGUsCiAgICAgICAgICBzZXBhcmF0ZUNsb3NlUG9wdXA6IHRydWUKICAgICAgICB9LAogICAgICAgIG9uOiBjYWNoZSh0aGlzLCAnbWVudScsIHsKICAgICAgICAgICcmc2Nyb2xsJzogdGhpcy5fX29uVmlydHVhbFNjcm9sbEV2dCwKICAgICAgICAgICdiZWZvcmUtaGlkZSc6IHRoaXMuX19jbG9zZU1lbnUKICAgICAgICB9KQogICAgICB9LCBjaGlsZCk7CiAgICB9LAogICAgX19vbkRpYWxvZ0ZpZWxkRm9jdXM6IGZ1bmN0aW9uIF9fb25EaWFsb2dGaWVsZEZvY3VzKGUpIHsKICAgICAgc3RvcChlKTsKICAgICAgdGhpcy4kcmVmcy50YXJnZXQgIT09IHZvaWQgMCAmJiB0aGlzLiRyZWZzLnRhcmdldC5mb2N1cygpOwogICAgICB0aGlzLmRpYWxvZ0ZpZWxkRm9jdXNlZCA9IHRydWU7CiAgICAgIHdpbmRvdy5zY3JvbGxUbyh3aW5kb3cucGFnZVhPZmZzZXQgfHwgd2luZG93LnNjcm9sbFggfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0IHx8IDAsIDApOwogICAgfSwKICAgIF9fb25EaWFsb2dGaWVsZEJsdXI6IGZ1bmN0aW9uIF9fb25EaWFsb2dGaWVsZEJsdXIoZSkgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICBzdG9wKGUpOwogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMxNS5kaWFsb2dGaWVsZEZvY3VzZWQgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgX19nZXREaWFsb2c6IGZ1bmN0aW9uIF9fZ2V0RGlhbG9nKGgpIHsKICAgICAgdmFyIF90aGlzMTYgPSB0aGlzOwoKICAgICAgdmFyIGNvbnRlbnQgPSBbaChRRmllbGQsIHsKICAgICAgICBzdGF0aWNDbGFzczogImNvbC1hdXRvICIuY29uY2F0KHRoaXMuZmllbGRDbGFzcyksCiAgICAgICAgcHJvcHM6IF9vYmplY3RTcHJlYWQoe30sIHRoaXMuJHByb3BzLCB7CiAgICAgICAgICAiZm9yIjogdGhpcy50YXJnZXRVaWQsCiAgICAgICAgICBkYXJrOiB0aGlzLmlzT3B0aW9uc0RhcmssCiAgICAgICAgICBzcXVhcmU6IHRydWUsCiAgICAgICAgICBsb2FkaW5nOiB0aGlzLmlubmVyTG9hZGluZywKICAgICAgICAgIGZpbGxlZDogdHJ1ZSwKICAgICAgICAgIHN0YWNrTGFiZWw6IHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPiAwCiAgICAgICAgfSksCiAgICAgICAgb246IF9vYmplY3RTcHJlYWQoe30sIHRoaXMucUxpc3RlbmVycywgewogICAgICAgICAgZm9jdXM6IHRoaXMuX19vbkRpYWxvZ0ZpZWxkRm9jdXMsCiAgICAgICAgICBibHVyOiB0aGlzLl9fb25EaWFsb2dGaWVsZEJsdXIKICAgICAgICB9KSwKICAgICAgICBzY29wZWRTbG90czogX29iamVjdFNwcmVhZCh7fSwgdGhpcy4kc2NvcGVkU2xvdHMsIHsKICAgICAgICAgIHJhd0NvbnRyb2w6IGZ1bmN0aW9uIHJhd0NvbnRyb2woKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczE2Ll9fZ2V0Q29udHJvbChoLCB0cnVlKTsKICAgICAgICAgIH0sCiAgICAgICAgICBiZWZvcmU6IHZvaWQgMCwKICAgICAgICAgIGFmdGVyOiB2b2lkIDAKICAgICAgICB9KQogICAgICB9KV07CiAgICAgIHRoaXMubWVudSA9PT0gdHJ1ZSAmJiBjb250ZW50LnB1c2goaCgnZGl2JywgewogICAgICAgIHJlZjogJ21lbnVDb250ZW50JywKICAgICAgICBzdGF0aWNDbGFzczogJ3Njcm9sbCcsCiAgICAgICAgImNsYXNzIjogdGhpcy5tZW51Q29udGVudENsYXNzLAogICAgICAgIHN0eWxlOiB0aGlzLnBvcHVwQ29udGVudFN0eWxlLAogICAgICAgIG9uOiBjYWNoZSh0aGlzLCAndmlydE1lbnUnLCB7CiAgICAgICAgICBjbGljazogcHJldmVudCwKICAgICAgICAgICcmc2Nyb2xsJzogdGhpcy5fX29uVmlydHVhbFNjcm9sbEV2dAogICAgICAgIH0pCiAgICAgIH0sIHRoaXMubm9PcHRpb25zID09PSB0cnVlID8gdGhpcy4kc2NvcGVkU2xvdHNbJ25vLW9wdGlvbiddICE9PSB2b2lkIDAgPyB0aGlzLiRzY29wZWRTbG90c1snbm8tb3B0aW9uJ10oewogICAgICAgIGlucHV0VmFsdWU6IHRoaXMuaW5wdXRWYWx1ZQogICAgICB9KSA6IG51bGwgOiB0aGlzLl9fZ2V0T3B0aW9ucyhoKSkpOwogICAgICByZXR1cm4gaChRRGlhbG9nLCB7CiAgICAgICAgcmVmOiAnZGlhbG9nJywKICAgICAgICBwcm9wczogewogICAgICAgICAgdmFsdWU6IHRoaXMuZGlhbG9nLAogICAgICAgICAgZGFyazogdGhpcy5pc09wdGlvbnNEYXJrLAogICAgICAgICAgcG9zaXRpb246IHRoaXMudXNlSW5wdXQgPT09IHRydWUgPyAndG9wJyA6IHZvaWQgMCwKICAgICAgICAgIHRyYW5zaXRpb25TaG93OiB0aGlzLnRyYW5zaXRpb25TaG93Q29tcHV0ZWQsCiAgICAgICAgICB0cmFuc2l0aW9uSGlkZTogdGhpcy50cmFuc2l0aW9uSGlkZQogICAgICAgIH0sCiAgICAgICAgb246IGNhY2hlKHRoaXMsICdkaWFsb2cnLCB7CiAgICAgICAgICAnYmVmb3JlLWhpZGUnOiB0aGlzLl9fb25EaWFsb2dCZWZvcmVIaWRlLAogICAgICAgICAgaGlkZTogdGhpcy5fX29uRGlhbG9nSGlkZSwKICAgICAgICAgIHNob3c6IHRoaXMuX19vbkRpYWxvZ1Nob3cKICAgICAgICB9KQogICAgICB9LCBbaCgnZGl2JywgewogICAgICAgIHN0YXRpY0NsYXNzOiAncS1zZWxlY3RfX2RpYWxvZycgKyAodGhpcy5pc09wdGlvbnNEYXJrID09PSB0cnVlID8gJyBxLXNlbGVjdF9fZGlhbG9nLS1kYXJrIHEtZGFyaycgOiAnJykgKyAodGhpcy5kaWFsb2dGaWVsZEZvY3VzZWQgPT09IHRydWUgPyAnIHEtc2VsZWN0X19kaWFsb2ctLWZvY3VzZWQnIDogJycpCiAgICAgIH0sIGNvbnRlbnQpXSk7CiAgICB9LAogICAgX19vbkRpYWxvZ0JlZm9yZUhpZGU6IGZ1bmN0aW9uIF9fb25EaWFsb2dCZWZvcmVIaWRlKCkgewogICAgICB0aGlzLiRyZWZzLmRpYWxvZy5fX3JlZm9jdXNUYXJnZXQgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcucS1maWVsZF9fbmF0aXZlID4gW3RhYmluZGV4XTpsYXN0LWNoaWxkJyk7CiAgICAgIHRoaXMuZm9jdXNlZCA9IGZhbHNlOwogICAgfSwKICAgIF9fb25EaWFsb2dIaWRlOiBmdW5jdGlvbiBfX29uRGlhbG9nSGlkZShlKSB7CiAgICAgIHRoaXMuaGlkZVBvcHVwKCk7CiAgICAgIHRoaXMuZm9jdXNlZCA9PT0gZmFsc2UgJiYgdGhpcy4kZW1pdCgnYmx1cicsIGUpOwoKICAgICAgdGhpcy5fX3Jlc2V0SW5wdXRWYWx1ZSgpOwogICAgfSwKICAgIF9fb25EaWFsb2dTaG93OiBmdW5jdGlvbiBfX29uRGlhbG9nU2hvdygpIHsKICAgICAgdmFyIGVsID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsgLy8gSUUgY2FuIGhhdmUgbnVsbCBkb2N1bWVudC5hY3RpdmVFbGVtZW50CgogICAgICBpZiAoKGVsID09PSBudWxsIHx8IGVsLmlkICE9PSB0aGlzLnRhcmdldFVpZCkgJiYgdGhpcy4kcmVmcy50YXJnZXQgIT09IGVsICYmIHRoaXMuJHJlZnMudGFyZ2V0ICE9PSB2b2lkIDApIHsKICAgICAgICB0aGlzLiRyZWZzLnRhcmdldC5mb2N1cygpOwogICAgICB9CiAgICB9LAogICAgX19jbG9zZU1lbnU6IGZ1bmN0aW9uIF9fY2xvc2VNZW51KCkgewogICAgICBpZiAodGhpcy5kaWFsb2cgPT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMub3B0aW9uSW5kZXggPSAtMTsKCiAgICAgIGlmICh0aGlzLm1lbnUgPT09IHRydWUpIHsKICAgICAgICB0aGlzLm1lbnUgPSBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZm9jdXNlZCA9PT0gZmFsc2UpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5maWx0ZXJJZCk7CiAgICAgICAgdGhpcy5maWx0ZXJJZCA9IHZvaWQgMDsKCiAgICAgICAgaWYgKHRoaXMuaW5uZXJMb2FkaW5nID09PSB0cnVlKSB7CiAgICAgICAgICB0aGlzLiRlbWl0KCdmaWx0ZXItYWJvcnQnKTsKICAgICAgICAgIHRoaXMuaW5uZXJMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2hvd1BvcHVwOiBmdW5jdGlvbiBzaG93UG9wdXAoZSkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5lZGl0YWJsZSAhPT0gdHJ1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaGFzRGlhbG9nID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy5fX29uQ29udHJvbEZvY3VzaW4oZSk7CgogICAgICAgIHRoaXMuZGlhbG9nID0gdHJ1ZTsKICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczE3Ll9fZm9jdXMoKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9fZm9jdXMoKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucUxpc3RlbmVycy5maWx0ZXIgIT09IHZvaWQgMCkgewogICAgICAgIHRoaXMuZmlsdGVyKHRoaXMuaW5wdXRWYWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5ub09wdGlvbnMgIT09IHRydWUgfHwgdGhpcy4kc2NvcGVkU2xvdHNbJ25vLW9wdGlvbiddICE9PSB2b2lkIDApIHsKICAgICAgICB0aGlzLm1lbnUgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgaGlkZVBvcHVwOiBmdW5jdGlvbiBoaWRlUG9wdXAoKSB7CiAgICAgIHRoaXMuZGlhbG9nID0gZmFsc2U7CgogICAgICB0aGlzLl9fY2xvc2VNZW51KCk7CiAgICB9LAogICAgX19yZXNldElucHV0VmFsdWU6IGZ1bmN0aW9uIF9fcmVzZXRJbnB1dFZhbHVlKCkgewogICAgICB0aGlzLnVzZUlucHV0ID09PSB0cnVlICYmIHRoaXMudXBkYXRlSW5wdXRWYWx1ZSh0aGlzLm11bHRpcGxlICE9PSB0cnVlICYmIHRoaXMuZmlsbElucHV0ID09PSB0cnVlICYmIHRoaXMuaW5uZXJWYWx1ZS5sZW5ndGggPiAwID8gdGhpcy5nZXRPcHRpb25MYWJlbCh0aGlzLmlubmVyVmFsdWVbMF0pIHx8ICcnIDogJycsIHRydWUsIHRydWUpOwogICAgfSwKICAgIF9fdXBkYXRlTWVudTogZnVuY3Rpb24gX191cGRhdGVNZW51KHNob3cpIHsKICAgICAgdmFyIF90aGlzMTggPSB0aGlzOwoKICAgICAgdmFyIG9wdGlvbkluZGV4ID0gLTE7CgogICAgICBpZiAoc2hvdyA9PT0gdHJ1ZSkgewogICAgICAgIGlmICh0aGlzLmlubmVyVmFsdWUubGVuZ3RoID4gMCkgewogICAgICAgICAgdmFyIHZhbCA9IHRoaXMuZ2V0T3B0aW9uVmFsdWUodGhpcy5pbm5lclZhbHVlWzBdKTsKICAgICAgICAgIG9wdGlvbkluZGV4ID0gdGhpcy5vcHRpb25zLmZpbmRJbmRleChmdW5jdGlvbiAodikgewogICAgICAgICAgICByZXR1cm4gaXNEZWVwRXF1YWwoX3RoaXMxOC5nZXRPcHRpb25WYWx1ZSh2KSwgdmFsKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5fX3Jlc2V0VmlydHVhbFNjcm9sbChvcHRpb25JbmRleCk7CiAgICAgIH0KCiAgICAgIHRoaXMuc2V0T3B0aW9uSW5kZXgob3B0aW9uSW5kZXgpOwogICAgfSwKICAgIF9fb25QcmVSZW5kZXI6IGZ1bmN0aW9uIF9fb25QcmVSZW5kZXIoKSB7CiAgICAgIHRoaXMuaGFzRGlhbG9nID0gdGhpcy4kcS5wbGF0Zm9ybS5pcy5tb2JpbGUgIT09IHRydWUgJiYgdGhpcy5iZWhhdmlvciAhPT0gJ2RpYWxvZycgPyBmYWxzZSA6IHRoaXMuYmVoYXZpb3IgIT09ICdtZW51JyAmJiAodGhpcy51c2VJbnB1dCA9PT0gdHJ1ZSA/IHRoaXMuJHNjb3BlZFNsb3RzWyduby1vcHRpb24nXSAhPT0gdm9pZCAwIHx8IHRoaXMucUxpc3RlbmVycy5maWx0ZXIgIT09IHZvaWQgMCB8fCB0aGlzLm5vT3B0aW9ucyA9PT0gZmFsc2UgOiB0cnVlKTsKICAgICAgdGhpcy50cmFuc2l0aW9uU2hvd0NvbXB1dGVkID0gdGhpcy5oYXNEaWFsb2cgPT09IHRydWUgJiYgdGhpcy51c2VJbnB1dCA9PT0gdHJ1ZSAmJiB0aGlzLiRxLnBsYXRmb3JtLmlzLmlvcyA9PT0gdHJ1ZSA/ICdmYWRlJyA6IHRoaXMudHJhbnNpdGlvblNob3c7CiAgICB9LAogICAgX19vblBvc3RSZW5kZXI6IGZ1bmN0aW9uIF9fb25Qb3N0UmVuZGVyKCkgewogICAgICBpZiAodGhpcy5kaWFsb2cgPT09IGZhbHNlICYmIHRoaXMuJHJlZnMubWVudSAhPT0gdm9pZCAwKSB7CiAgICAgICAgdGhpcy4kcmVmcy5tZW51LnVwZGF0ZVBvc2l0aW9uKCk7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVNZW51UG9zaXRpb246IGZ1bmN0aW9uIHVwZGF0ZU1lbnVQb3NpdGlvbigpIHsKICAgICAgdGhpcy5fX29uUG9zdFJlbmRlcigpOwogICAgfQogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgIGNsZWFyVGltZW91dCh0aGlzLmlucHV0VGltZXIpOwogIH0KfSk7"},{"version":3,"sources":["/Users/jonny/Desktop/myProjects/Kalaam-core/FE/node_modules/quasar/src/components/select/QSelect.js"],"names":["Vue","QField","QIcon","QChip","QItem","QItemSection","QItemLabel","QMenu","QDialog","isDeepEqual","stop","prevent","stopAndPrevent","normalizeToInterval","shouldIgnoreKey","isKeyCode","mergeSlot","cache","FormFieldMixin","VirtualScroll","CompositionMixin","ListenersMixin","validateNewValueMode","v","includes","reEscapeList","extend","name","mixins","props","value","required","multiple","Boolean","displayValue","String","Number","displayValueSanitize","dropdownIcon","options","type","Array","optionValue","Function","optionLabel","optionDisable","hideSelected","hideDropdownIcon","fillInput","maxValues","optionsDense","optionsDark","optionsSelectedClass","optionsSanitize","optionsCover","menuShrink","menuAnchor","menuSelf","menuOffset","popupContentClass","popupContentStyle","Object","useInput","useChips","newValueMode","validator","mapOptions","emitValue","inputDebounce","inputClass","inputStyle","tabindex","transitionShow","transitionHide","behavior","data","menu","dialog","optionIndex","inputValue","dialogFieldFocused","watch","innerValue","handler","val","innerValueCache","innerLoading","hasValue","userInputValue","__resetInputValue","filter","immediate","show","__updateMenu","computed","isOptionsDark","isDark","virtualScrollLength","isArray","length","fieldClass","computedInputClass","menuContentClass","virtualScrollHorizontal","mapNull","values","map","__getOption","noOptions","selectedString","opt","getOptionLabel","join","sanitizeFn","sanitize","displayAsText","some","computedTabindex","focused","selectedScope","i","index","selected","removeAtIndex","__removeAtIndexAndFocus","toggleOption","optionScope","virtualScrollSliceRange","from","to","slice","disable","isOptionDisabled","itemProps","clickable","active","activeClass","computedOptionsSelectedClass","manualFocus","dense","dark","isOptionSelected","itemEvents","click","$q","platform","is","desktop","mousemove","setOptionIndex","dropdownArrowIcon","iconSet","arrow","dropdown","squaredMenu","outlined","standout","borderless","rounded","color","innerOptionsValue","getOptionValue","__getPropValueFn","inputControlEvents","on","input","__onInput","change","__onChange","keydown","__onTargetKeydown","keyup","__onTargetKeyup","keypress","__onTargetKeypress","focus","__selectInputText","e","hasDialog","compositionstart","compositionupdate","compositionend","__onComposition","methods","getEmittingOptionValue","model","$emit","splice","__focus","add","unique","updateInputValue","push","keepOpen","editable","optValue","hidePopup","$refs","target","findIndex","moveOptionSelection","offset","skipInputValue","scrollTo","__setInputValue","defaultInputValue","fn","find","propName","defaultVal","select","__onTargetAutocomplete","keyCode","needle","toLocaleLowerCase","option","indexOf","newValueModeValid","qListeners","tabShouldSelect","shiftKey","__closeMenu","id","targetUid","showPopup","optionsLength","searchBuffer","searchBufferExp","Date","now","key","altKey","ctrlKey","char","keyRepeat","searchRe","RegExp","split","l","test","$nextTick","done","mode","__getVirtualScrollEl","menuContent","__portal","$el","__getVirtualScrollTarget","__getSelection","h","fromDialog","domProps","textContent","$scopedSlots","scope","removable","textColor","remove","staticClass","__getControl","child","isTarget","__getInput","ref","attrs","qAttrs","autocomplete","nameProp","opts","__getOptions","__padVirtualScroll","concat","__getInnerAppend","loading","style","maxlength","autofocus","disabled","readonly","clearTimeout","inputTimer","composing","setTimeout","noFiltering","internal","filterId","afterFn","__getControlEvents","focusout","__onControlFocusout","focusin","__onControlFocusin","__onControlPopupShow","hasPopupOpen","classList","contains","__getControlChild","__getMenu","fit","cover","anchor","self","contentClass","contentStyle","noParentEvent","noRefocus","noFocus","square","separateClosePopup","__onVirtualScrollEvt","__onDialogFieldFocus","window","pageXOffset","scrollX","document","body","scrollLeft","__onDialogFieldBlur","__getDialog","content","$props","filled","stackLabel","blur","scopedSlots","rawControl","before","after","position","transitionShowComputed","__onDialogBeforeHide","hide","__onDialogHide","__onDialogShow","__refocusTarget","querySelector","el","activeElement","__resetVirtualScroll","__onPreRender","mobile","ios","__onPostRender","updatePosition","updateMenuPosition","beforeDestroy"],"mappings":"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","sourcesContent":["import Vue from 'vue'\n\nimport QField from '../field/QField.js'\nimport QIcon from '../icon/QIcon.js'\nimport QChip from '../chip/QChip.js'\n\nimport QItem from '../item/QItem.js'\nimport QItemSection from '../item/QItemSection.js'\nimport QItemLabel from '../item/QItemLabel.js'\n\nimport QMenu from '../menu/QMenu.js'\nimport QDialog from '../dialog/QDialog.js'\n\nimport { isDeepEqual } from '../../utils/is.js'\nimport { stop, prevent, stopAndPrevent } from '../../utils/event.js'\nimport { normalizeToInterval } from '../../utils/format.js'\nimport { shouldIgnoreKey, isKeyCode } from '../../utils/key-composition.js'\nimport { mergeSlot } from '../../utils/slot.js'\nimport cache from '../../utils/cache.js'\n\nimport { FormFieldMixin } from '../../mixins/form.js'\nimport VirtualScroll from '../../mixins/virtual-scroll.js'\nimport CompositionMixin from '../../mixins/composition.js'\nimport ListenersMixin from '../../mixins/listeners.js'\n\nconst validateNewValueMode = v => ['add', 'add-unique', 'toggle'].includes(v)\nconst reEscapeList = '.*+?^${}()|[]\\\\'\n\nexport default Vue.extend({\n  name: 'QSelect',\n\n  mixins: [\n    QField,\n    VirtualScroll,\n    CompositionMixin,\n    FormFieldMixin,\n    ListenersMixin\n  ],\n\n  props: {\n    value: {\n      required: true\n    },\n\n    multiple: Boolean,\n\n    displayValue: [String, Number],\n    displayValueSanitize: Boolean,\n    dropdownIcon: String,\n\n    options: {\n      type: Array,\n      default: () => []\n    },\n\n    optionValue: [Function, String],\n    optionLabel: [Function, String],\n    optionDisable: [Function, String],\n\n    hideSelected: Boolean,\n    hideDropdownIcon: Boolean,\n    fillInput: Boolean,\n\n    maxValues: [Number, String],\n\n    optionsDense: Boolean,\n    optionsDark: {\n      type: Boolean,\n      default: null\n    },\n    optionsSelectedClass: String,\n    optionsSanitize: Boolean,\n\n    optionsCover: Boolean,\n\n    menuShrink: Boolean,\n    menuAnchor: String,\n    menuSelf: String,\n    menuOffset: Array,\n\n    popupContentClass: String,\n    popupContentStyle: [String, Array, Object],\n\n    useInput: Boolean,\n    useChips: Boolean,\n\n    newValueMode: {\n      type: String,\n      validator: validateNewValueMode\n    },\n\n    mapOptions: Boolean,\n    emitValue: Boolean,\n\n    inputDebounce: {\n      type: [Number, String],\n      default: 500\n    },\n\n    inputClass: [Array, String, Object],\n    inputStyle: [Array, String, Object],\n\n    tabindex: {\n      type: [String, Number],\n      default: 0\n    },\n\n    transitionShow: String,\n    transitionHide: String,\n\n    behavior: {\n      type: String,\n      validator: v => ['default', 'menu', 'dialog'].includes(v),\n      default: 'default'\n    }\n  },\n\n  data () {\n    return {\n      menu: false,\n      dialog: false,\n      optionIndex: -1,\n      inputValue: '',\n      dialogFieldFocused: false\n    }\n  },\n\n  watch: {\n    innerValue: {\n      handler (val) {\n        this.innerValueCache = val\n\n        if (\n          this.useInput === true &&\n          this.fillInput === true &&\n          this.multiple !== true &&\n          // Prevent re-entering in filter while filtering\n          // Also prevent clearing inputValue while filtering\n          this.innerLoading !== true &&\n          ((this.dialog !== true && this.menu !== true) || this.hasValue !== true)\n        ) {\n          this.userInputValue !== true && this.__resetInputValue()\n          if (this.dialog === true || this.menu === true) {\n            this.filter('')\n          }\n        }\n      },\n      immediate: true\n    },\n\n    fillInput () {\n      this.__resetInputValue()\n    },\n\n    menu (show) {\n      this.__updateMenu(show)\n    }\n  },\n\n  computed: {\n    isOptionsDark () {\n      return this.optionsDark === null\n        ? this.isDark\n        : this.optionsDark\n    },\n\n    virtualScrollLength () {\n      return Array.isArray(this.options)\n        ? this.options.length\n        : 0\n    },\n\n    fieldClass () {\n      return `q-select q-field--auto-height q-select--with${this.useInput !== true ? 'out' : ''}-input q-select--with${this.useChips !== true ? 'out' : ''}-chips`\n    },\n\n    computedInputClass () {\n      if (this.hideSelected === true || this.innerValue.length === 0) {\n        return this.inputClass\n      }\n\n      return this.inputClass === void 0\n        ? 'q-field__input--padding'\n        : [this.inputClass, 'q-field__input--padding']\n    },\n\n    menuContentClass () {\n      return (this.virtualScrollHorizontal === true ? 'q-virtual-scroll--horizontal' : '') +\n        (this.popupContentClass ? ' ' + this.popupContentClass : '')\n    },\n\n    innerValue () {\n      const\n        mapNull = this.mapOptions === true && this.multiple !== true,\n        val = this.value !== void 0 && (this.value !== null || mapNull === true)\n          ? (this.multiple === true && Array.isArray(this.value) ? this.value : [ this.value ])\n          : []\n\n      if (this.mapOptions === true && Array.isArray(this.options) === true) {\n        const cache = this.mapOptions === true && this.innerValueCache !== void 0\n          ? this.innerValueCache\n          : []\n        const values = val.map(v => this.__getOption(v, cache))\n\n        return this.value === null && mapNull === true\n          ? values.filter(v => v !== null)\n          : values\n      }\n\n      return val\n    },\n\n    noOptions () {\n      return this.virtualScrollLength === 0\n    },\n\n    selectedString () {\n      return this.innerValue\n        .map(opt => this.getOptionLabel(opt))\n        .join(', ')\n    },\n\n    sanitizeFn () {\n      return this.optionsSanitize === true\n        ? () => true\n        : opt => opt !== void 0 && opt !== null && opt.sanitize === true\n    },\n\n    displayAsText () {\n      return this.displayValueSanitize === true || (\n        this.displayValue === void 0 && (\n          this.optionsSanitize === true ||\n          this.innerValue.some(this.sanitizeFn)\n        )\n      )\n    },\n\n    computedTabindex () {\n      return this.focused === true ? this.tabindex : -1\n    },\n\n    selectedScope () {\n      return this.innerValue.map((opt, i) => ({\n        index: i,\n        opt,\n        sanitize: this.sanitizeFn(opt),\n        selected: true,\n        removeAtIndex: this.__removeAtIndexAndFocus,\n        toggleOption: this.toggleOption,\n        tabindex: this.computedTabindex\n      }))\n    },\n\n    optionScope () {\n      if (this.virtualScrollLength === 0) {\n        return []\n      }\n\n      const { from, to } = this.virtualScrollSliceRange\n\n      return this.options.slice(from, to).map((opt, i) => {\n        const disable = this.isOptionDisabled(opt) === true\n        const index = from + i\n\n        const itemProps = {\n          clickable: true,\n          active: false,\n          activeClass: this.computedOptionsSelectedClass,\n          manualFocus: true,\n          focused: false,\n          disable,\n          tabindex: -1,\n          dense: this.optionsDense,\n          dark: this.isOptionsDark\n        }\n\n        if (disable !== true) {\n          this.isOptionSelected(opt) === true && (itemProps.active = true)\n          this.optionIndex === index && (itemProps.focused = true)\n        }\n\n        const itemEvents = {\n          click: () => { this.toggleOption(opt) }\n        }\n\n        if (this.$q.platform.is.desktop === true) {\n          itemEvents.mousemove = () => { this.setOptionIndex(index) }\n        }\n\n        return {\n          index,\n          opt,\n          sanitize: this.sanitizeFn(opt),\n          selected: itemProps.active,\n          focused: itemProps.focused,\n          toggleOption: this.toggleOption,\n          setOptionIndex: this.setOptionIndex,\n          itemProps,\n          itemEvents\n        }\n      })\n    },\n\n    dropdownArrowIcon () {\n      return this.dropdownIcon !== void 0\n        ? this.dropdownIcon\n        : this.$q.iconSet.arrow.dropdown\n    },\n\n    squaredMenu () {\n      return this.optionsCover === false &&\n        this.outlined !== true &&\n        this.standout !== true &&\n        this.borderless !== true &&\n        this.rounded !== true\n    },\n\n    computedOptionsSelectedClass () {\n      return this.optionsSelectedClass !== void 0\n        ? this.optionsSelectedClass\n        : (this.color !== void 0 ? `text-${this.color}` : '')\n    },\n\n    innerOptionsValue () {\n      return this.innerValue.map(opt => this.getOptionValue(opt))\n    },\n\n    // returns method to get value of an option;\n    // takes into account 'option-value' prop\n    getOptionValue () {\n      return this.__getPropValueFn('optionValue', 'value')\n    },\n\n    // returns method to get label of an option;\n    // takes into account 'option-label' prop\n    getOptionLabel () {\n      return this.__getPropValueFn('optionLabel', 'label')\n    },\n\n    // returns method to tell if an option is disabled;\n    // takes into account 'option-disable' prop\n    isOptionDisabled () {\n      return this.__getPropValueFn('optionDisable', 'disable')\n    },\n\n    inputControlEvents () {\n      const on = {\n        input: this.__onInput,\n        // Safari < 10.2 & UIWebView doesn't fire compositionend when\n        // switching focus before confirming composition choice\n        // this also fixes the issue where some browsers e.g. iOS Chrome\n        // fires \"change\" instead of \"input\" on autocomplete.\n        change: this.__onChange,\n        keydown: this.__onTargetKeydown,\n        keyup: this.__onTargetKeyup,\n        keypress: this.__onTargetKeypress,\n        focus: this.__selectInputText,\n        click: e => {\n          this.hasDialog === true && stop(e)\n        }\n      }\n\n      on.compositionstart = on.compositionupdate = on.compositionend = this.__onComposition\n\n      return on\n    }\n  },\n\n  methods: {\n    getEmittingOptionValue (opt) {\n      return this.emitValue === true\n        ? this.getOptionValue(opt)\n        : opt\n    },\n\n    removeAtIndex (index) {\n      if (index > -1 && index < this.innerValue.length) {\n        if (this.multiple === true) {\n          const model = this.value.slice()\n          this.$emit('remove', { index, value: model.splice(index, 1)[0] })\n          this.$emit('input', model)\n        }\n        else {\n          this.$emit('input', null)\n        }\n      }\n    },\n\n    __removeAtIndexAndFocus (index) {\n      this.removeAtIndex(index)\n      this.__focus()\n    },\n\n    add (opt, unique) {\n      const val = this.getEmittingOptionValue(opt)\n\n      if (this.multiple !== true) {\n        this.fillInput === true && this.updateInputValue(\n          this.getOptionLabel(opt),\n          true,\n          true\n        )\n\n        this.$emit('input', val)\n        return\n      }\n\n      if (this.innerValue.length === 0) {\n        this.$emit('add', { index: 0, value: val })\n        this.$emit('input', this.multiple === true ? [ val ] : val)\n        return\n      }\n\n      if (unique === true && this.isOptionSelected(opt) === true) {\n        return\n      }\n\n      if (this.maxValues !== void 0 && this.value.length >= this.maxValues) {\n        return\n      }\n\n      const model = this.value.slice()\n\n      this.$emit('add', { index: model.length, value: val })\n      model.push(val)\n      this.$emit('input', model)\n    },\n\n    toggleOption (opt, keepOpen) {\n      if (this.editable !== true || opt === void 0 || this.isOptionDisabled(opt) === true) {\n        return\n      }\n\n      const optValue = this.getOptionValue(opt)\n\n      if (this.multiple !== true) {\n        if (keepOpen !== true) {\n          this.updateInputValue(\n            this.fillInput === true ? this.getOptionLabel(opt) : '',\n            true,\n            true\n          )\n\n          this.hidePopup()\n        }\n\n        this.$refs.target !== void 0 && this.$refs.target.focus()\n\n        if (isDeepEqual(this.getOptionValue(this.innerValue[0]), optValue) !== true) {\n          this.$emit('input', this.emitValue === true ? optValue : opt)\n        }\n        return\n      }\n\n      (this.hasDialog !== true || this.dialogFieldFocused === true) && this.__focus()\n\n      this.__selectInputText()\n\n      if (this.innerValue.length === 0) {\n        const val = this.emitValue === true ? optValue : opt\n        this.$emit('add', { index: 0, value: val })\n        this.$emit('input', this.multiple === true ? [ val ] : val)\n        return\n      }\n\n      const\n        model = this.value.slice(),\n        index = this.innerOptionsValue.findIndex(v => isDeepEqual(v, optValue))\n\n      if (index > -1) {\n        this.$emit('remove', { index, value: model.splice(index, 1)[0] })\n      }\n      else {\n        if (this.maxValues !== void 0 && model.length >= this.maxValues) {\n          return\n        }\n\n        const val = this.emitValue === true ? optValue : opt\n\n        this.$emit('add', { index: model.length, value: val })\n        model.push(val)\n      }\n\n      this.$emit('input', model)\n    },\n\n    setOptionIndex (index) {\n      if (this.$q.platform.is.desktop !== true) { return }\n\n      const val = index > -1 && index < this.virtualScrollLength\n        ? index\n        : -1\n\n      if (this.optionIndex !== val) {\n        this.optionIndex = val\n      }\n    },\n\n    moveOptionSelection (offset = 1, skipInputValue) {\n      if (this.menu === true) {\n        let index = this.optionIndex\n        do {\n          index = normalizeToInterval(\n            index + offset,\n            -1,\n            this.virtualScrollLength - 1\n          )\n        }\n        while (index !== -1 && index !== this.optionIndex && this.isOptionDisabled(this.options[index]) === true)\n\n        if (this.optionIndex !== index) {\n          this.setOptionIndex(index)\n          this.scrollTo(index)\n\n          if (skipInputValue !== true && this.useInput === true && this.fillInput === true) {\n            this.__setInputValue(index >= 0\n              ? this.getOptionLabel(this.options[index])\n              : this.defaultInputValue\n            )\n          }\n        }\n      }\n    },\n\n    __getOption (value, innerValueCache) {\n      const fn = opt => isDeepEqual(this.getOptionValue(opt), value)\n      return this.options.find(fn) || innerValueCache.find(fn) || value\n    },\n\n    __getPropValueFn (propName, defaultVal) {\n      const val = this[propName] !== void 0\n        ? this[propName]\n        : defaultVal\n\n      return typeof val === 'function'\n        ? val\n        : opt => Object(opt) === opt && val in opt\n          ? opt[val]\n          : opt\n    },\n\n    isOptionSelected (opt) {\n      const val = this.getOptionValue(opt)\n      return this.innerOptionsValue.find(v => isDeepEqual(v, val)) !== void 0\n    },\n\n    __selectInputText () {\n      if (this.useInput === true && this.$refs.target !== void 0) {\n        this.$refs.target.select()\n      }\n    },\n\n    __onTargetKeyup (e) {\n      // if ESC and we have an opened menu\n      // then stop propagation (might be caught by a QDialog\n      // and so it will also close the QDialog, which is wrong)\n      if (isKeyCode(e, 27) === true && this.menu === true) {\n        stop(e)\n        // on ESC we need to close the dialog also\n        this.hidePopup()\n        this.__resetInputValue()\n      }\n\n      this.$emit('keyup', e)\n    },\n\n    __onTargetAutocomplete (e) {\n      const { value } = e.target\n\n      e.target.value = ''\n\n      if (e.keyCode !== void 0) {\n        this.__onTargetKeyup(e)\n        return\n      }\n\n      if (typeof value === 'string' && value.length > 0) {\n        const needle = value.toLocaleLowerCase()\n\n        let fn = opt => this.getOptionValue(opt).toLocaleLowerCase() === needle\n        let option = this.options.find(fn)\n\n        if (option !== null) {\n          this.innerValue.indexOf(option) === -1 && this.toggleOption(option)\n        }\n        else {\n          fn = opt => this.getOptionLabel(opt).toLocaleLowerCase() === needle\n          option = this.options.find(fn)\n\n          if (option !== null) {\n            this.innerValue.indexOf(option) === -1 && this.toggleOption(option)\n          }\n        }\n      }\n    },\n\n    __onTargetKeypress (e) {\n      this.$emit('keypress', e)\n    },\n\n    __onTargetKeydown (e) {\n      this.$emit('keydown', e)\n\n      if (shouldIgnoreKey(e) === true) {\n        return\n      }\n\n      const newValueModeValid = this.inputValue.length > 0 &&\n        (this.newValueMode !== void 0 || this.qListeners['new-value'] !== void 0)\n      const tabShouldSelect = e.shiftKey !== true &&\n        this.multiple !== true &&\n        (this.optionIndex > -1 || newValueModeValid === true)\n\n      // escape\n      if (e.keyCode === 27) {\n        prevent(e) // prevent clearing the inputValue\n        return\n      }\n\n      // tab\n      if (e.keyCode === 9 && tabShouldSelect === false) {\n        this.__closeMenu()\n        return\n      }\n\n      if (e.target === void 0 || e.target.id !== this.targetUid) { return }\n\n      // down\n      if (\n        e.keyCode === 40 &&\n        this.innerLoading !== true &&\n        this.menu === false\n      ) {\n        stopAndPrevent(e)\n        this.showPopup()\n        return\n      }\n\n      // backspace\n      if (\n        e.keyCode === 8 &&\n        this.multiple === true &&\n        this.hideSelected !== true &&\n        this.inputValue.length === 0 &&\n        Array.isArray(this.value)\n      ) {\n        this.removeAtIndex(this.value.length - 1)\n        return\n      }\n\n      // up, down\n      if (e.keyCode === 38 || e.keyCode === 40) {\n        stopAndPrevent(e)\n        this.moveOptionSelection(e.keyCode === 38 ? -1 : 1, this.multiple)\n      }\n\n      const optionsLength = this.virtualScrollLength\n\n      // clear search buffer if expired\n      if (this.searchBuffer === void 0 || this.searchBufferExp < Date.now()) {\n        this.searchBuffer = ''\n      }\n\n      // keyboard search when not having use-input\n      if (\n        optionsLength > 0 &&\n        this.useInput !== true &&\n        e.key.length === 1 && // printable char\n        e.altKey === e.ctrlKey && // not kbd shortcut\n        (e.keyCode !== 32 || this.searchBuffer.length > 0) // space in middle of search\n      ) {\n        this.menu !== true && this.showPopup(e)\n\n        const\n          char = e.key.toLocaleLowerCase(),\n          keyRepeat = this.searchBuffer.length === 1 && this.searchBuffer[0] === char\n\n        this.searchBufferExp = Date.now() + 1500\n        if (keyRepeat === false) {\n          stopAndPrevent(e)\n          this.searchBuffer += char\n        }\n\n        const searchRe = new RegExp('^' + this.searchBuffer.split('').map(l => reEscapeList.indexOf(l) > -1 ? '\\\\' + l : l).join('.*'), 'i')\n\n        let index = this.optionIndex\n\n        if (keyRepeat === true || index < 0 || searchRe.test(this.getOptionLabel(this.options[index])) !== true) {\n          do {\n            index = normalizeToInterval(index + 1, -1, optionsLength - 1)\n          }\n          while (index !== this.optionIndex && (\n            this.isOptionDisabled(this.options[index]) === true ||\n            searchRe.test(this.getOptionLabel(this.options[index])) !== true\n          ))\n        }\n\n        if (this.optionIndex !== index) {\n          this.$nextTick(() => {\n            this.setOptionIndex(index)\n            this.scrollTo(index)\n\n            if (index >= 0 && this.useInput === true && this.fillInput === true) {\n              this.__setInputValue(this.getOptionLabel(this.options[index]))\n            }\n          })\n        }\n\n        return\n      }\n\n      // enter, space (when not using use-input and not in search), or tab (when not using multiple and option selected)\n      // same target is checked above\n      if (\n        e.keyCode !== 13 &&\n        (e.keyCode !== 32 || this.useInput === true || this.searchBuffer !== '') &&\n        (e.keyCode !== 9 || tabShouldSelect === false)\n      ) { return }\n\n      e.keyCode !== 9 && stopAndPrevent(e)\n\n      if (this.optionIndex > -1 && this.optionIndex < optionsLength) {\n        this.toggleOption(this.options[this.optionIndex])\n        return\n      }\n\n      if (newValueModeValid === true) {\n        const done = (val, mode) => {\n          if (mode) {\n            if (validateNewValueMode(mode) !== true) {\n              return\n            }\n          }\n          else {\n            mode = this.newValueMode\n          }\n\n          if (val === void 0 || val === null) {\n            return\n          }\n\n          this.updateInputValue('', this.multiple !== true, true)\n\n          this[mode === 'toggle' ? 'toggleOption' : 'add'](\n            val,\n            mode === 'add-unique'\n          )\n\n          if (this.multiple !== true) {\n            this.$refs.target !== void 0 && this.$refs.target.focus()\n            this.hidePopup()\n          }\n        }\n\n        if (this.qListeners['new-value'] !== void 0) {\n          this.$emit('new-value', this.inputValue, done)\n        }\n        else {\n          done(this.inputValue)\n        }\n\n        if (this.multiple !== true) {\n          return\n        }\n      }\n\n      if (this.menu === true) {\n        this.__closeMenu()\n      }\n      else if (this.innerLoading !== true) {\n        this.showPopup()\n      }\n    },\n\n    __getVirtualScrollEl () {\n      return this.hasDialog === true\n        ? this.$refs.menuContent\n        : (\n          this.$refs.menu !== void 0 && this.$refs.menu.__portal !== void 0\n            ? this.$refs.menu.__portal.$el\n            : void 0\n        )\n    },\n\n    __getVirtualScrollTarget () {\n      return this.__getVirtualScrollEl()\n    },\n\n    __getSelection (h, fromDialog) {\n      if (this.hideSelected === true) {\n        return fromDialog === true || this.dialog !== true || this.hasDialog !== true\n          ? []\n          : [\n            h('span', {\n              domProps: {\n                textContent: this.inputValue\n              }\n            })\n          ]\n      }\n\n      if (this.$scopedSlots['selected-item'] !== void 0) {\n        return this.selectedScope.map(scope => this.$scopedSlots['selected-item'](scope)).slice()\n      }\n\n      if (this.$scopedSlots.selected !== void 0) {\n        return this.$scopedSlots.selected().slice()\n      }\n\n      if (this.useChips === true) {\n        return this.selectedScope.map((scope, i) => h(QChip, {\n          key: 'option-' + i,\n          props: {\n            removable: this.editable === true && this.isOptionDisabled(scope.opt) !== true,\n            dense: true,\n            textColor: this.color,\n            tabindex: this.computedTabindex\n          },\n          on: cache(this, 'rem#' + i, {\n            remove () { scope.removeAtIndex(i) }\n          })\n        }, [\n          h('span', {\n            staticClass: 'ellipsis',\n            domProps: {\n              [scope.sanitize === true ? 'textContent' : 'innerHTML']: this.getOptionLabel(scope.opt)\n            }\n          })\n        ]))\n      }\n\n      return [\n        h('span', {\n          domProps: {\n            [this.displayAsText ? 'textContent' : 'innerHTML']: this.displayValue !== void 0\n              ? this.displayValue\n              : this.selectedString\n          }\n        })\n      ]\n    },\n\n    __getControl (h, fromDialog) {\n      const child = this.__getSelection(h, fromDialog)\n      const isTarget = fromDialog === true || this.dialog !== true || this.hasDialog !== true\n\n      if (isTarget === true && this.useInput === true) {\n        child.push(this.__getInput(h, fromDialog))\n      }\n      else if (this.editable === true) {\n        isTarget === true && child.push(\n          h('div', {\n            // there can be only one (when dialog is opened the control in dialog should be target)\n            ref: 'target',\n            key: 'd_t',\n            staticClass: 'no-outline',\n            attrs: {\n              id: this.targetUid,\n              tabindex: this.tabindex\n            },\n            on: cache(this, 'f-tget', {\n              keydown: this.__onTargetKeydown,\n              keyup: this.__onTargetKeyup,\n              keypress: this.__onTargetKeypress\n            })\n          })\n        )\n\n        this.qAttrs.autocomplete !== void 0 && child.push(\n          h('input', {\n            staticClass: 'q-select__autocomplete-input no-outline',\n            attrs: { autocomplete: this.qAttrs.autocomplete },\n            on: cache(this, 'autoinp', {\n              keyup: this.__onTargetAutocomplete\n            })\n          })\n        )\n      }\n\n      if (this.nameProp !== void 0 && this.disable !== true && this.innerOptionsValue.length > 0) {\n        const opts = this.innerOptionsValue.map(value => h('option', {\n          attrs: { value, selected: true }\n        }))\n\n        child.push(\n          h('select', {\n            staticClass: 'hidden',\n            attrs: {\n              name: this.nameProp,\n              multiple: this.multiple\n            }\n          }, opts)\n        )\n      }\n\n      return h('div', { staticClass: 'q-field__native row items-center', attrs: this.qAttrs }, child)\n    },\n\n    __getOptions (h) {\n      if (this.menu !== true) {\n        return void 0\n      }\n\n      const fn = this.$scopedSlots.option !== void 0\n        ? this.$scopedSlots.option\n        : scope => h(QItem, {\n          key: scope.index,\n          props: scope.itemProps,\n          on: scope.itemEvents\n        }, [\n          h(QItemSection, [\n            h(QItemLabel, {\n              domProps: {\n                [scope.sanitize === true ? 'textContent' : 'innerHTML']: this.getOptionLabel(scope.opt)\n              }\n            })\n          ])\n        ])\n\n      let options = this.__padVirtualScroll(h, 'div', this.optionScope.map(fn))\n\n      if (this.$scopedSlots['before-options'] !== void 0) {\n        options = this.$scopedSlots['before-options']().concat(options)\n      }\n\n      return mergeSlot(options, this, 'after-options')\n    },\n\n    __getInnerAppend (h) {\n      return this.loading !== true && this.innerLoading !== true && this.hideDropdownIcon !== true\n        ? [\n          h(QIcon, {\n            staticClass: 'q-select__dropdown-icon',\n            props: { name: this.dropdownArrowIcon }\n          })\n        ]\n        : null\n    },\n\n    __getInput (h, fromDialog) {\n      const options = {\n        ref: 'target',\n        key: 'i_t',\n        staticClass: 'q-field__input q-placeholder col',\n        style: this.inputStyle,\n        class: this.computedInputClass,\n        domProps: { value: this.inputValue !== void 0 ? this.inputValue : '' },\n        attrs: {\n          // required for Android in order to show ENTER key when in form\n          type: 'search',\n          ...this.qAttrs,\n          id: this.targetUid,\n          maxlength: this.maxlength, // this is converted to prop by QField\n          tabindex: this.tabindex,\n          'data-autofocus': fromDialog === true ? false : this.autofocus,\n          disabled: this.disable === true,\n          readonly: this.readonly === true\n        },\n        on: this.inputControlEvents\n      }\n\n      if (fromDialog !== true && this.hasDialog === true) {\n        options.staticClass += ' no-pointer-events'\n        options.attrs.readonly = true\n      }\n\n      return h('input', options)\n    },\n\n    __onChange (e) {\n      this.__onComposition(e)\n    },\n\n    __onInput (e) {\n      clearTimeout(this.inputTimer)\n\n      if (e && e.target && e.target.composing === true) {\n        return\n      }\n\n      this.__setInputValue(e.target.value || '')\n      // mark it here as user input so that if updateInputValue is called\n      // before filter is called the indicator is reset\n      this.userInputValue = true\n      this.defaultInputValue = this.inputValue\n\n      if (\n        this.focused !== true &&\n        (this.hasDialog !== true || this.dialogFieldFocused === true)\n      ) {\n        this.__focus()\n      }\n\n      if (this.qListeners.filter !== void 0) {\n        this.inputTimer = setTimeout(() => {\n          this.filter(this.inputValue)\n        }, this.inputDebounce)\n      }\n    },\n\n    __setInputValue (inputValue) {\n      if (this.inputValue !== inputValue) {\n        this.inputValue = inputValue\n        this.$emit('input-value', inputValue)\n      }\n    },\n\n    updateInputValue (val, noFiltering, internal) {\n      this.userInputValue = internal !== true\n\n      if (this.useInput === true) {\n        this.__setInputValue(val)\n\n        if (noFiltering === true || internal !== true) {\n          this.defaultInputValue = val\n        }\n\n        noFiltering !== true && this.filter(val)\n      }\n    },\n\n    filter (val) {\n      if (this.qListeners.filter === void 0 || this.focused !== true) {\n        return\n      }\n\n      if (this.innerLoading === true) {\n        this.$emit('filter-abort')\n      }\n      else {\n        this.innerLoading = true\n      }\n\n      if (\n        val !== '' &&\n        this.multiple !== true &&\n        this.innerValue.length > 0 &&\n        this.userInputValue !== true &&\n        val === this.getOptionLabel(this.innerValue[0])\n      ) {\n        val = ''\n      }\n\n      const filterId = setTimeout(() => {\n        this.menu === true && (this.menu = false)\n      }, 10)\n      clearTimeout(this.filterId)\n      this.filterId = filterId\n\n      this.$emit(\n        'filter',\n        val,\n        (fn, afterFn) => {\n          if (this.focused === true && this.filterId === filterId) {\n            clearTimeout(this.filterId)\n\n            typeof fn === 'function' && fn()\n\n            this.$nextTick(() => {\n              this.innerLoading = false\n\n              if (this.editable === true) {\n                if (this.menu === true) {\n                  this.__updateMenu(true)\n                }\n                else {\n                  this.menu = true\n                }\n              }\n\n              typeof afterFn === 'function' && this.$nextTick(() => { afterFn(this) })\n            })\n          }\n        },\n        () => {\n          if (this.focused === true && this.filterId === filterId) {\n            clearTimeout(this.filterId)\n            this.innerLoading = false\n          }\n          this.menu === true && (this.menu = false)\n        }\n      )\n    },\n\n    __getControlEvents () {\n      const focusout = e => {\n        this.__onControlFocusout(e, () => {\n          this.__resetInputValue()\n          this.__closeMenu()\n        })\n      }\n\n      return {\n        focusin: this.__onControlFocusin,\n        focusout,\n        'popup-show': this.__onControlPopupShow,\n        'popup-hide': e => {\n          e !== void 0 && stop(e)\n          this.$emit('popup-hide', e)\n          this.hasPopupOpen = false\n          focusout(e)\n        },\n        click: e => {\n          if (this.hasDialog !== true) {\n            // label from QField will propagate click on the input (except IE)\n            if (\n              (this.useInput === true && e.target.classList.contains('q-field__input') !== true) ||\n              (this.useInput !== true && e.target.classList.contains('no-outline') === true)\n            ) {\n              return\n            }\n\n            if (this.menu === true) {\n              this.__closeMenu()\n              this.$refs.target !== void 0 && this.$refs.target.focus()\n              return\n            }\n          }\n\n          this.showPopup(e)\n        }\n      }\n    },\n\n    __getControlChild (h) {\n      if (\n        this.editable !== false && (\n          this.dialog === true || // dialog always has menu displayed, so need to render it\n          this.noOptions !== true ||\n          this.$scopedSlots['no-option'] !== void 0\n        )\n      ) {\n        return this[`__get${this.hasDialog === true ? 'Dialog' : 'Menu'}`](h)\n      }\n    },\n\n    __getMenu (h) {\n      const child = this.noOptions === true\n        ? (\n          this.$scopedSlots['no-option'] !== void 0\n            ? this.$scopedSlots['no-option']({ inputValue: this.inputValue })\n            : null\n        )\n        : this.__getOptions(h)\n\n      return h(QMenu, {\n        ref: 'menu',\n        props: {\n          value: this.menu,\n          fit: this.menuShrink !== true,\n          cover: this.optionsCover === true && this.noOptions !== true && this.useInput !== true,\n          anchor: this.menuAnchor,\n          self: this.menuSelf,\n          offset: this.menuOffset,\n          contentClass: this.menuContentClass,\n          contentStyle: this.popupContentStyle,\n          dark: this.isOptionsDark,\n          noParentEvent: true,\n          noRefocus: true,\n          noFocus: true,\n          square: this.squaredMenu,\n          transitionShow: this.transitionShow,\n          transitionHide: this.transitionHide,\n          separateClosePopup: true\n        },\n        on: cache(this, 'menu', {\n          '&scroll': this.__onVirtualScrollEvt,\n          'before-hide': this.__closeMenu\n        })\n      }, child)\n    },\n\n    __onDialogFieldFocus (e) {\n      stop(e)\n      this.$refs.target !== void 0 && this.$refs.target.focus()\n      this.dialogFieldFocused = true\n      window.scrollTo(window.pageXOffset || window.scrollX || document.body.scrollLeft || 0, 0)\n    },\n\n    __onDialogFieldBlur (e) {\n      stop(e)\n      this.$nextTick(() => {\n        this.dialogFieldFocused = false\n      })\n    },\n\n    __getDialog (h) {\n      const content = [\n        h(QField, {\n          staticClass: `col-auto ${this.fieldClass}`,\n          props: {\n            ...this.$props,\n            for: this.targetUid,\n            dark: this.isOptionsDark,\n            square: true,\n            loading: this.innerLoading,\n            filled: true,\n            stackLabel: this.inputValue.length > 0\n          },\n          on: {\n            ...this.qListeners,\n            focus: this.__onDialogFieldFocus,\n            blur: this.__onDialogFieldBlur\n          },\n          scopedSlots: {\n            ...this.$scopedSlots,\n            rawControl: () => this.__getControl(h, true),\n            before: void 0,\n            after: void 0\n          }\n        })\n      ]\n\n      this.menu === true && content.push(\n        h('div', {\n          ref: 'menuContent',\n          staticClass: 'scroll',\n          class: this.menuContentClass,\n          style: this.popupContentStyle,\n          on: cache(this, 'virtMenu', {\n            click: prevent,\n            '&scroll': this.__onVirtualScrollEvt\n          })\n        }, (\n          this.noOptions === true\n            ? (\n              this.$scopedSlots['no-option'] !== void 0\n                ? this.$scopedSlots['no-option']({ inputValue: this.inputValue })\n                : null\n            )\n            : this.__getOptions(h)\n        ))\n      )\n\n      return h(QDialog, {\n        ref: 'dialog',\n        props: {\n          value: this.dialog,\n          dark: this.isOptionsDark,\n          position: this.useInput === true ? 'top' : void 0,\n          transitionShow: this.transitionShowComputed,\n          transitionHide: this.transitionHide\n        },\n        on: cache(this, 'dialog', {\n          'before-hide': this.__onDialogBeforeHide,\n          hide: this.__onDialogHide,\n          show: this.__onDialogShow\n        })\n      }, [\n        h('div', {\n          staticClass: 'q-select__dialog' +\n            (this.isOptionsDark === true ? ' q-select__dialog--dark q-dark' : '') +\n            (this.dialogFieldFocused === true ? ' q-select__dialog--focused' : '')\n        }, content)\n      ])\n    },\n\n    __onDialogBeforeHide () {\n      this.$refs.dialog.__refocusTarget = this.$el.querySelector('.q-field__native > [tabindex]:last-child')\n      this.focused = false\n    },\n\n    __onDialogHide (e) {\n      this.hidePopup()\n      this.focused === false && this.$emit('blur', e)\n      this.__resetInputValue()\n    },\n\n    __onDialogShow () {\n      const el = document.activeElement\n      // IE can have null document.activeElement\n      if (\n        (el === null || el.id !== this.targetUid) &&\n        this.$refs.target !== el &&\n        this.$refs.target !== void 0\n      ) {\n        this.$refs.target.focus()\n      }\n    },\n\n    __closeMenu () {\n      if (this.dialog === true) {\n        return\n      }\n\n      this.optionIndex = -1\n\n      if (this.menu === true) {\n        this.menu = false\n      }\n\n      if (this.focused === false) {\n        clearTimeout(this.filterId)\n        this.filterId = void 0\n\n        if (this.innerLoading === true) {\n          this.$emit('filter-abort')\n          this.innerLoading = false\n        }\n      }\n    },\n\n    showPopup (e) {\n      if (this.editable !== true) {\n        return\n      }\n\n      if (this.hasDialog === true) {\n        this.__onControlFocusin(e)\n        this.dialog = true\n        this.$nextTick(() => {\n          this.__focus()\n        })\n      }\n      else {\n        this.__focus()\n      }\n\n      if (this.qListeners.filter !== void 0) {\n        this.filter(this.inputValue)\n      }\n      else if (this.noOptions !== true || this.$scopedSlots['no-option'] !== void 0) {\n        this.menu = true\n      }\n    },\n\n    hidePopup () {\n      this.dialog = false\n      this.__closeMenu()\n    },\n\n    __resetInputValue () {\n      this.useInput === true && this.updateInputValue(\n        this.multiple !== true && this.fillInput === true && this.innerValue.length > 0\n          ? this.getOptionLabel(this.innerValue[0]) || ''\n          : '',\n        true,\n        true\n      )\n    },\n\n    __updateMenu (show) {\n      let optionIndex = -1\n\n      if (show === true) {\n        if (this.innerValue.length > 0) {\n          const val = this.getOptionValue(this.innerValue[0])\n          optionIndex = this.options.findIndex(v => isDeepEqual(this.getOptionValue(v), val))\n        }\n\n        this.__resetVirtualScroll(optionIndex)\n      }\n\n      this.setOptionIndex(optionIndex)\n    },\n\n    __onPreRender () {\n      this.hasDialog = this.$q.platform.is.mobile !== true && this.behavior !== 'dialog'\n        ? false\n        : this.behavior !== 'menu' && (\n          this.useInput === true\n            ? this.$scopedSlots['no-option'] !== void 0 || this.qListeners.filter !== void 0 || this.noOptions === false\n            : true\n        )\n\n      this.transitionShowComputed = this.hasDialog === true && this.useInput === true && this.$q.platform.is.ios === true\n        ? 'fade'\n        : this.transitionShow\n    },\n\n    __onPostRender () {\n      if (this.dialog === false && this.$refs.menu !== void 0) {\n        this.$refs.menu.updatePosition()\n      }\n    },\n\n    updateMenuPosition () {\n      this.__onPostRender()\n    }\n  },\n\n  beforeDestroy () {\n    clearTimeout(this.inputTimer)\n  }\n})\n"]}]}